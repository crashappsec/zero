{
  "metadata": {
    "version": "1.0.0",
    "updated": "2025-01-15",
    "description": "Regular expression patterns for detecting secrets in source code"
  },
  "patterns": {
    "aws": {
      "access_key_id": {
        "pattern": "(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}",
        "description": "AWS Access Key ID",
        "severity": "critical",
        "example": "AKIAIOSFODNN7EXAMPLE",
        "rotation_guide": "1. Go to IAM console\n2. Find the access key\n3. Create new key\n4. Update applications\n5. Deactivate old key\n6. Delete old key after verification"
      },
      "secret_access_key": {
        "pattern": "[A-Za-z0-9/+=]{40}",
        "description": "AWS Secret Access Key (requires context)",
        "severity": "critical",
        "context_required": true,
        "context_patterns": ["aws", "secret", "key", "access"]
      },
      "session_token": {
        "pattern": "FwoGZXIvYXdzE[A-Za-z0-9/+=]+",
        "description": "AWS Session Token",
        "severity": "high"
      },
      "mws_auth_token": {
        "pattern": "amzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
        "description": "Amazon MWS Auth Token",
        "severity": "critical"
      }
    },
    "gcp": {
      "api_key": {
        "pattern": "AIza[0-9A-Za-z\\-_]{35}",
        "description": "Google Cloud API Key",
        "severity": "high",
        "example": "AIzaSyDaGmWKa4JsXZ-HjGw7ISLn_3namBGewQe"
      },
      "service_account": {
        "pattern": "\"type\"\\s*:\\s*\"service_account\"",
        "description": "GCP Service Account JSON",
        "severity": "critical",
        "file_patterns": ["*.json"]
      },
      "oauth_client_id": {
        "pattern": "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com",
        "description": "Google OAuth Client ID",
        "severity": "medium"
      },
      "oauth_client_secret": {
        "pattern": "GOCSPX-[A-Za-z0-9_-]{28}",
        "description": "Google OAuth Client Secret",
        "severity": "high"
      }
    },
    "azure": {
      "storage_account_key": {
        "pattern": "[A-Za-z0-9+/=]{88}",
        "description": "Azure Storage Account Key",
        "severity": "critical",
        "context_required": true,
        "context_patterns": ["azure", "storage", "account"]
      },
      "connection_string": {
        "pattern": "DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[^;]+",
        "description": "Azure Storage Connection String",
        "severity": "critical"
      },
      "sas_token": {
        "pattern": "sv=[0-9]{4}-[0-9]{2}-[0-9]{2}&s[a-z]=[a-z]+&s[a-z]{2}=[^&]+&se=[^&]+&sp=[^&]+&sig=[A-Za-z0-9%]+",
        "description": "Azure SAS Token",
        "severity": "high"
      },
      "client_secret": {
        "pattern": "[A-Za-z0-9_~.-]{34}",
        "description": "Azure AD Client Secret",
        "severity": "critical",
        "context_required": true,
        "context_patterns": ["azure", "client", "secret", "ad"]
      }
    },
    "github": {
      "personal_access_token_classic": {
        "pattern": "ghp_[A-Za-z0-9]{36}",
        "description": "GitHub Personal Access Token (Classic)",
        "severity": "critical",
        "example": "ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
      },
      "personal_access_token_fine": {
        "pattern": "github_pat_[A-Za-z0-9]{22}_[A-Za-z0-9]{59}",
        "description": "GitHub Personal Access Token (Fine-grained)",
        "severity": "critical"
      },
      "oauth_access_token": {
        "pattern": "gho_[A-Za-z0-9]{36}",
        "description": "GitHub OAuth Access Token",
        "severity": "critical"
      },
      "app_token": {
        "pattern": "(ghu|ghs)_[A-Za-z0-9]{36}",
        "description": "GitHub App Token",
        "severity": "critical"
      },
      "refresh_token": {
        "pattern": "ghr_[A-Za-z0-9]{36}",
        "description": "GitHub Refresh Token",
        "severity": "critical"
      }
    },
    "gitlab": {
      "personal_access_token": {
        "pattern": "glpat-[A-Za-z0-9_-]{20}",
        "description": "GitLab Personal Access Token",
        "severity": "critical"
      },
      "pipeline_trigger_token": {
        "pattern": "glptt-[A-Za-z0-9_-]{40}",
        "description": "GitLab Pipeline Trigger Token",
        "severity": "high"
      },
      "runner_registration_token": {
        "pattern": "GR1348941[A-Za-z0-9_-]{20}",
        "description": "GitLab Runner Registration Token",
        "severity": "high"
      }
    },
    "stripe": {
      "secret_key_live": {
        "pattern": "sk_live_[A-Za-z0-9]{24,}",
        "description": "Stripe Live Secret Key",
        "severity": "critical",
        "rotation_guide": "1. Go to Stripe Dashboard > Developers > API Keys\n2. Roll the secret key\n3. Update applications immediately"
      },
      "secret_key_test": {
        "pattern": "sk_test_[A-Za-z0-9]{24,}",
        "description": "Stripe Test Secret Key",
        "severity": "medium"
      },
      "restricted_key": {
        "pattern": "rk_(live|test)_[A-Za-z0-9]{24,}",
        "description": "Stripe Restricted API Key",
        "severity": "high"
      },
      "publishable_key": {
        "pattern": "pk_(live|test)_[A-Za-z0-9]{24,}",
        "description": "Stripe Publishable Key",
        "severity": "low",
        "note": "Publishable keys are meant to be public but should still be tracked"
      }
    },
    "slack": {
      "bot_token": {
        "pattern": "xoxb-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{24}",
        "description": "Slack Bot Token",
        "severity": "high"
      },
      "user_token": {
        "pattern": "xoxp-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{24,32}",
        "description": "Slack User Token",
        "severity": "critical"
      },
      "workspace_token": {
        "pattern": "xoxa-2-[0-9]{10,13}-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{64}",
        "description": "Slack Workspace Access Token",
        "severity": "critical"
      },
      "webhook_url": {
        "pattern": "https://hooks\\.slack\\.com/services/T[A-Z0-9]{8,}/B[A-Z0-9]{8,}/[A-Za-z0-9]{24}",
        "description": "Slack Webhook URL",
        "severity": "medium"
      }
    },
    "twilio": {
      "account_sid": {
        "pattern": "AC[a-f0-9]{32}",
        "description": "Twilio Account SID",
        "severity": "medium"
      },
      "auth_token": {
        "pattern": "[a-f0-9]{32}",
        "description": "Twilio Auth Token",
        "severity": "high",
        "context_required": true,
        "context_patterns": ["twilio", "auth"]
      },
      "api_key": {
        "pattern": "SK[a-f0-9]{32}",
        "description": "Twilio API Key",
        "severity": "high"
      }
    },
    "sendgrid": {
      "api_key": {
        "pattern": "SG\\.[A-Za-z0-9_-]{22}\\.[A-Za-z0-9_-]{43}",
        "description": "SendGrid API Key",
        "severity": "high"
      }
    },
    "mailchimp": {
      "api_key": {
        "pattern": "[a-f0-9]{32}-us[0-9]{1,2}",
        "description": "Mailchimp API Key",
        "severity": "high"
      }
    },
    "npm": {
      "access_token": {
        "pattern": "npm_[A-Za-z0-9]{36}",
        "description": "NPM Access Token",
        "severity": "critical"
      }
    },
    "pypi": {
      "api_token": {
        "pattern": "pypi-AgEIcHlwaS5vcmc[A-Za-z0-9_-]{50,}",
        "description": "PyPI API Token",
        "severity": "critical"
      }
    },
    "generic": {
      "private_key_rsa": {
        "pattern": "-----BEGIN RSA PRIVATE KEY-----",
        "description": "RSA Private Key",
        "severity": "critical"
      },
      "private_key_openssh": {
        "pattern": "-----BEGIN OPENSSH PRIVATE KEY-----",
        "description": "OpenSSH Private Key",
        "severity": "critical"
      },
      "private_key_ec": {
        "pattern": "-----BEGIN EC PRIVATE KEY-----",
        "description": "EC Private Key",
        "severity": "critical"
      },
      "private_key_dsa": {
        "pattern": "-----BEGIN DSA PRIVATE KEY-----",
        "description": "DSA Private Key",
        "severity": "critical"
      },
      "private_key_generic": {
        "pattern": "-----BEGIN PRIVATE KEY-----",
        "description": "Generic Private Key (PKCS#8)",
        "severity": "critical"
      },
      "pgp_private_key": {
        "pattern": "-----BEGIN PGP PRIVATE KEY BLOCK-----",
        "description": "PGP Private Key",
        "severity": "critical"
      },
      "jwt": {
        "pattern": "eyJ[A-Za-z0-9_-]*\\.eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*",
        "description": "JSON Web Token",
        "severity": "medium",
        "note": "JWTs may be intentionally included but should be reviewed"
      },
      "basic_auth_url": {
        "pattern": "https?://[^:]+:[^@]+@",
        "description": "Basic Auth Credentials in URL",
        "severity": "high"
      },
      "password_in_config": {
        "pattern": "(?i)(password|passwd|pwd)\\s*[=:]\\s*['\"][^'\"]{8,}['\"]",
        "description": "Password in Configuration",
        "severity": "critical"
      },
      "api_key_generic": {
        "pattern": "(?i)(api[_-]?key|apikey)\\s*[=:]\\s*['\"][A-Za-z0-9_-]{20,}['\"]",
        "description": "Generic API Key",
        "severity": "high"
      },
      "secret_generic": {
        "pattern": "(?i)(secret|token)\\s*[=:]\\s*['\"][A-Za-z0-9_-]{20,}['\"]",
        "description": "Generic Secret/Token",
        "severity": "high"
      }
    }
  },
  "file_patterns": {
    "high_risk": [
      ".env",
      ".env.*",
      "*.pem",
      "*.key",
      "*.p12",
      "*.pfx",
      "credentials.json",
      "secrets.json",
      "service-account.json",
      ".npmrc",
      ".pypirc",
      ".netrc",
      ".htpasswd"
    ],
    "medium_risk": [
      "config.json",
      "settings.json",
      "application.yml",
      "application.properties",
      "database.yml",
      "docker-compose.yml",
      "*.tfvars"
    ],
    "check_gitignore": [
      ".env",
      "*.pem",
      "*.key",
      "credentials*",
      "secrets*"
    ]
  },
  "false_positive_indicators": [
    "example",
    "sample",
    "test",
    "dummy",
    "fake",
    "placeholder",
    "your_",
    "xxx",
    "CHANGE_ME",
    "TODO",
    "<",
    ">"
  ]
}
