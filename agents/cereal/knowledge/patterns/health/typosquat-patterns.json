{
  "metadata": {
    "version": "1.0.0",
    "updated": "2025-01-15",
    "category": "supply-chain/health",
    "description": "Patterns and techniques for detecting typosquatting attacks on package names"
  },
  "typosquatting_techniques": {
    "character_substitution": {
      "description": "Replacing characters with similar-looking ones",
      "examples": [
        {"original": "lodash", "typosquat": "1odash", "technique": "l → 1"},
        {"original": "requests", "typosquat": "reqeusts", "technique": "transposition"},
        {"original": "colors", "typosquat": "co1ors", "technique": "l → 1"}
      ],
      "common_substitutions": {
        "l": ["1", "I", "|"],
        "o": ["0"],
        "s": ["5"],
        "a": ["4", "@"],
        "e": ["3"],
        "i": ["1", "l"],
        "rn": ["m"],
        "vv": ["w"]
      }
    },
    "homoglyphs": {
      "description": "Using Unicode characters that look similar to ASCII",
      "examples": [
        {"original": "example", "typosquat": "exаmple", "technique": "Cyrillic 'а' (U+0430)"},
        {"original": "package", "typosquat": "pаckage", "technique": "Cyrillic 'а' (U+0430)"}
      ],
      "dangerous_characters": {
        "cyrillic_a": "а (U+0430) vs a (U+0061)",
        "cyrillic_e": "е (U+0435) vs e (U+0065)",
        "cyrillic_o": "о (U+043E) vs o (U+006F)",
        "cyrillic_c": "с (U+0441) vs c (U+0063)",
        "greek_omicron": "ο (U+03BF) vs o (U+006F)"
      },
      "detection": "Check for non-ASCII characters in package names"
    },
    "hyphen_manipulation": {
      "description": "Adding, removing, or changing hyphens/underscores",
      "examples": [
        {"original": "python-dateutil", "typosquat": "python_dateutil", "technique": "hyphen to underscore"},
        {"original": "cross-env", "typosquat": "crossenv", "technique": "hyphen removal"},
        {"original": "node-uuid", "typosquat": "nodeuuid", "technique": "hyphen removal"},
        {"original": "setuptools", "typosquat": "setup-tools", "technique": "hyphen insertion"}
      ]
    },
    "prefix_suffix": {
      "description": "Adding common prefixes or suffixes",
      "examples": [
        {"original": "colors", "typosquat": "node-colors", "technique": "node- prefix"},
        {"original": "express", "typosquat": "expressjs", "technique": "js suffix"},
        {"original": "react", "typosquat": "react-js", "technique": "-js suffix"},
        {"original": "lodash", "typosquat": "lodash-utils", "technique": "-utils suffix"}
      ],
      "common_prefixes": ["node-", "npm-", "py-", "python-", "js-", "lib-"],
      "common_suffixes": ["-js", "-node", "-py", "-lib", "-util", "-utils", "-core"]
    },
    "scope_manipulation": {
      "description": "Exploiting scoped vs unscoped package confusion",
      "examples": [
        {"original": "@babel/core", "typosquat": "babel-core", "technique": "scope removal"},
        {"original": "@types/react", "typosquat": "types-react", "technique": "scope removal"},
        {"original": "lodash", "typosquat": "@npm/lodash", "technique": "fake scope"}
      ]
    },
    "common_misspellings": {
      "description": "Natural typing errors",
      "patterns": [
        {"pattern": "double letter omission", "example": "coffe → coffee"},
        {"pattern": "adjacent key", "example": "requets → request"},
        {"pattern": "transposition", "example": "reqeusts → requests"},
        {"pattern": "vowel omission", "example": "lodsh → lodash"}
      ],
      "keyboard_adjacencies": {
        "q": ["w", "a"],
        "w": ["q", "e", "s"],
        "e": ["w", "r", "d"],
        "r": ["e", "t", "f"],
        "t": ["r", "y", "g"]
      }
    },
    "version_in_name": {
      "description": "Including version numbers in package name",
      "examples": [
        {"original": "lodash", "typosquat": "lodash4", "technique": "version suffix"},
        {"original": "webpack", "typosquat": "webpack5", "technique": "version suffix"}
      ]
    }
  },
  "detection_algorithms": {
    "levenshtein_distance": {
      "description": "Edit distance between package names",
      "threshold": 1,
      "usage": "Flag packages with distance ≤ 2 from popular packages"
    },
    "soundex": {
      "description": "Phonetic algorithm for similar-sounding names",
      "usage": "Detect names that sound alike when spoken"
    },
    "jaro_winkler": {
      "description": "String similarity with prefix weighting",
      "threshold": 0.9,
      "usage": "Good for detecting transpositions and short strings"
    },
    "keyboard_distance": {
      "description": "Physical distance between keys on keyboard",
      "usage": "Detect adjacent-key typos"
    }
  },
  "high_value_targets": {
    "npm": [
      "lodash", "express", "react", "axios", "moment",
      "webpack", "babel-core", "request", "commander", "chalk",
      "async", "underscore", "debug", "uuid", "bluebird",
      "jquery", "typescript", "eslint", "prettier", "jest"
    ],
    "pypi": [
      "requests", "numpy", "pandas", "django", "flask",
      "boto3", "tensorflow", "pytorch", "scikit-learn", "beautifulsoup4",
      "pillow", "selenium", "celery", "redis", "psycopg2"
    ],
    "rubygems": [
      "rails", "rack", "bundler", "nokogiri", "rspec",
      "puma", "sidekiq", "devise", "pg", "redis"
    ]
  },
  "known_incidents": [
    {
      "typosquat": "crossenv",
      "target": "cross-env",
      "ecosystem": "npm",
      "year": 2017,
      "impact": "Credential theft",
      "description": "Malicious package stealing npm credentials"
    },
    {
      "typosquat": "event-stream (compromised)",
      "target": "event-stream",
      "ecosystem": "npm",
      "year": 2018,
      "impact": "Bitcoin wallet theft",
      "description": "Legitimate package compromised via new maintainer"
    },
    {
      "typosquat": "python3-dateutil",
      "target": "python-dateutil",
      "ecosystem": "pypi",
      "year": 2019,
      "impact": "Credential theft",
      "description": "Targeted Python developers"
    },
    {
      "typosquat": "ua-parser-js (compromised)",
      "target": "ua-parser-js",
      "ecosystem": "npm",
      "year": 2021,
      "impact": "Cryptocurrency miner, password stealer",
      "description": "Popular package hijacked"
    },
    {
      "typosquat": "colors (sabotaged)",
      "target": "colors",
      "ecosystem": "npm",
      "year": 2022,
      "impact": "Denial of service",
      "description": "Maintainer intentionally corrupted package"
    }
  ],
  "prevention_strategies": {
    "for_developers": [
      "Double-check package names before installing",
      "Use lockfiles to pin dependencies",
      "Review new dependencies before adding",
      "Use package manager audit features",
      "Prefer scoped packages from known publishers"
    ],
    "for_organizations": [
      "Maintain approved package allowlist",
      "Use private registry mirror with validation",
      "Implement pre-commit hooks for dependency review",
      "Regular dependency audits",
      "Training on supply chain security"
    ],
    "for_registries": [
      "Block packages too similar to popular ones",
      "Require email verification for new publishers",
      "Implement waiting period for new packages",
      "Scan packages for malicious behavior",
      "Reserve common typos of popular packages"
    ]
  },
  "analysis_workflow": {
    "steps": [
      {
        "step": 1,
        "action": "Extract all dependencies from manifest",
        "tool": "Package manager parse"
      },
      {
        "step": 2,
        "action": "Check each against high-value targets list",
        "algorithm": "Levenshtein distance ≤ 2"
      },
      {
        "step": 3,
        "action": "Check for homoglyphs",
        "algorithm": "Unicode normalization comparison"
      },
      {
        "step": 4,
        "action": "Verify publisher reputation",
        "data": "Registry API for maintainer info"
      },
      {
        "step": 5,
        "action": "Check package age and download count",
        "heuristic": "New package with name similar to popular = suspicious"
      }
    ]
  }
}
