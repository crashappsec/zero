<!--
Copyright (c) 2025 Crash Override Inc. - https://crashoverride.com

SPDX-License-Identifier: GPL-3.0
-->

# Prompt: SBOM Vulnerability Scan

## Purpose
Comprehensive vulnerability scanning of an SBOM with prioritization based on severity, exploitation status, and CISA KEV presence.

## When to Use
- Regular security audits
- Pre-deployment security checks
- Incident response (checking for specific CVEs)
- Compliance requirements
- Third-party software assessment

## Prompt

```
I need a comprehensive vulnerability scan of this SBOM. Please:

1. Parse and validate the SBOM structure
2. Extract all components with versions
3. Query OSV.dev for vulnerabilities in each component
4. Cross-reference with deps.dev security advisories
5. Check all CVEs against the CISA Known Exploited Vulnerabilities catalog
6. Provide a detailed report including:
   - Executive summary with total vulnerability counts by severity
   - Detailed vulnerability table with:
     * CVE ID
     * Affected component and version
     * CVSS score
     * CISA KEV status (if applicable)
     * CWE classification
     * Description
     * Remediation recommendations
   - Prioritized remediation list (CISA KEV first, then by CVSS)
   - Specific version upgrades to fix vulnerabilities

[Paste SBOM content here]
```

## Expected Output
A structured report containing:
- Executive summary with vulnerability counts
- Detailed vulnerability analysis
- CISA KEV flagged items (highest priority)
- Remediation recommendations with specific version numbers
- Risk prioritization

## Variations

### Quick Security Check
For faster analysis focusing on critical/high severity:
```
Scan this SBOM for Critical and High severity vulnerabilities only.
Prioritize any matches in CISA KEV catalog.

[Paste SBOM]
```

### Specific CVE Check
To check if a specific CVE affects the SBOM:
```
Check if CVE-2024-XXXXX affects any components in this SBOM.
If yes, provide:
- Affected component(s) and version(s)
- Severity and CVSS score
- Available patches or workarounds
- CISA KEV status

[Paste SBOM]
```

### Transitive Dependency Focus
To focus on indirect dependencies:
```
Analyze this SBOM with focus on transitive (indirect) dependencies.
Identify vulnerabilities in packages that are not direct dependencies.

[Paste SBOM]
```

## Examples

### Example Usage
```
I need a comprehensive vulnerability scan of this SBOM...

[CycloneDX SBOM with express, axios, log4j, etc.]
```

### Example Output Structure
```markdown
# SBOM Vulnerability Analysis Report

## Executive Summary
- Total Components: 25
- Critical Vulnerabilities: 2 (1 in CISA KEV)
- High Vulnerabilities: 5
- Medium Vulnerabilities: 8

## CISA KEV Matches (IMMEDIATE ACTION REQUIRED)
1. CVE-2021-44228 (Log4Shell) in log4j-core 2.14.0
   - CVSS: 10.0 (Critical)
   - Fix: Upgrade to 2.17.1+

## Critical Vulnerabilities
[Detailed list...]

## Remediation Priority
1. [IMMEDIATE] Upgrade log4j-core (CISA KEV)
2. [HIGH] Upgrade axios
3. [MEDIUM] Update express
...
```

## Tips
- Provide the complete SBOM (including transitive dependencies if possible)
- Specify if you want focus on specific ecosystems (npm, Maven, PyPI, etc.)
- Mention if there are deployment constraints (can't upgrade major versions, etc.)
- Request comparison with a baseline if tracking remediation progress
