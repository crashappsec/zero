{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://zero.security/schemas/sbom.config.schema.json",
  "title": "Zero SBOM Configuration Schema",
  "description": "Configuration schema for SBOM generation across multiple package manager ecosystems",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "_version": {
      "type": "string",
      "description": "Schema version",
      "const": "1.0.0"
    },
    "_docs": {
      "type": "string",
      "description": "Documentation comment"
    },
    "_docs2": {
      "type": "string",
      "description": "Documentation comment"
    },
    "_docs3": {
      "type": "string",
      "description": "Documentation comment"
    },
    "_docs4": {
      "type": "string",
      "description": "Documentation comment"
    },
    "_docs5": {
      "type": "string",
      "description": "Documentation comment"
    },
    "_docs6": {
      "type": "string",
      "description": "Documentation comment"
    },
    "output": {
      "type": "object",
      "description": "SBOM output configuration",
      "properties": {
        "format": {
          "type": "string",
          "enum": ["cyclonedx", "spdx"],
          "default": "cyclonedx",
          "description": "SBOM format specification"
        },
        "spec_version": {
          "type": "string",
          "description": "Specification version (e.g., '1.5' for CycloneDX, '2.3' for SPDX)",
          "default": "1.5"
        },
        "output_format": {
          "type": "string",
          "enum": ["json", "xml"],
          "default": "json",
          "description": "Output file format"
        },
        "filename": {
          "type": "string",
          "default": "sbom.json",
          "description": "Output filename"
        },
        "include_serial_number": {
          "type": "boolean",
          "default": true,
          "description": "Include unique serial number in SBOM"
        },
        "include_timestamp": {
          "type": "boolean",
          "default": true,
          "description": "Include generation timestamp"
        }
      },
      "additionalProperties": false
    },
    "dependencies": {
      "type": "object",
      "description": "Dependency inclusion settings",
      "properties": {
        "include_dev": {
          "type": "boolean",
          "default": false,
          "description": "Include development dependencies"
        },
        "include_test": {
          "type": "boolean",
          "default": false,
          "description": "Include test dependencies"
        },
        "include_optional": {
          "type": "boolean",
          "default": true,
          "description": "Include optional dependencies"
        },
        "include_peer": {
          "type": "boolean",
          "default": true,
          "description": "Include peer dependencies (JavaScript ecosystems)"
        },
        "include_transitive": {
          "type": "boolean",
          "default": true,
          "description": "Include transitive (indirect) dependencies"
        },
        "include_build": {
          "type": "boolean",
          "default": false,
          "description": "Include build-time dependencies"
        }
      },
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "description": "SBOM metadata fields",
      "properties": {
        "include_licenses": {
          "type": "boolean",
          "default": true,
          "description": "Include license information for each component"
        },
        "include_hashes": {
          "type": "boolean",
          "default": true,
          "description": "Include cryptographic hashes (SHA-256, SHA-512)"
        },
        "include_urls": {
          "type": "boolean",
          "default": true,
          "description": "Include package URLs and download locations"
        },
        "include_descriptions": {
          "type": "boolean",
          "default": false,
          "description": "Include package descriptions"
        },
        "include_authors": {
          "type": "boolean",
          "default": false,
          "description": "Include author/maintainer information"
        },
        "include_purl": {
          "type": "boolean",
          "default": true,
          "description": "Include Package URL (PURL) identifiers"
        },
        "include_cpe": {
          "type": "boolean",
          "default": false,
          "description": "Include CPE identifiers where available"
        }
      },
      "additionalProperties": false
    },
    "tool_preferences": {
      "type": "object",
      "description": "Preferred SBOM generation tools per ecosystem",
      "properties": {
        "default": {
          "type": "string",
          "enum": ["auto", "cdxgen", "syft", "native"],
          "default": "auto",
          "description": "Default tool selection strategy"
        },
        "fallback_enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable fallback to alternative tools on failure"
        },
        "javascript": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "python": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "rust": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "go": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "java": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "ruby": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "php": {
          "$ref": "#/definitions/ecosystem_tool_config"
        },
        "dotnet": {
          "$ref": "#/definitions/ecosystem_tool_config"
        }
      },
      "additionalProperties": false
    },
    "package_managers": {
      "type": "object",
      "description": "Package manager-specific configurations",
      "properties": {
        "npm": {
          "$ref": "#/definitions/npm_config"
        },
        "yarn": {
          "$ref": "#/definitions/yarn_config"
        },
        "pnpm": {
          "$ref": "#/definitions/pnpm_config"
        },
        "pip": {
          "$ref": "#/definitions/pip_config"
        },
        "poetry": {
          "$ref": "#/definitions/poetry_config"
        },
        "uv": {
          "$ref": "#/definitions/uv_config"
        },
        "cargo": {
          "$ref": "#/definitions/cargo_config"
        },
        "go": {
          "$ref": "#/definitions/go_config"
        },
        "maven": {
          "$ref": "#/definitions/maven_config"
        },
        "gradle": {
          "$ref": "#/definitions/gradle_config"
        },
        "bundler": {
          "$ref": "#/definitions/bundler_config"
        },
        "composer": {
          "$ref": "#/definitions/composer_config"
        },
        "nuget": {
          "$ref": "#/definitions/nuget_config"
        }
      },
      "additionalProperties": false
    },
    "registries": {
      "type": "object",
      "description": "Private registry configurations",
      "properties": {
        "npm": {
          "$ref": "#/definitions/registry_config"
        },
        "pypi": {
          "$ref": "#/definitions/registry_config"
        },
        "maven": {
          "$ref": "#/definitions/registry_config"
        },
        "nuget": {
          "$ref": "#/definitions/registry_config"
        },
        "rubygems": {
          "$ref": "#/definitions/registry_config"
        },
        "packagist": {
          "$ref": "#/definitions/registry_config"
        },
        "crates": {
          "$ref": "#/definitions/registry_config"
        },
        "go": {
          "$ref": "#/definitions/registry_config"
        }
      },
      "additionalProperties": true
    },
    "integrity": {
      "type": "object",
      "description": "Integrity verification settings",
      "properties": {
        "verify_lockfiles": {
          "type": "boolean",
          "default": true,
          "description": "Verify lock file integrity before SBOM generation"
        },
        "require_lockfile": {
          "type": "boolean",
          "default": false,
          "description": "Fail if no lock file is present"
        },
        "verify_checksums": {
          "type": "boolean",
          "default": true,
          "description": "Verify package checksums against lock file"
        },
        "detect_drift": {
          "type": "boolean",
          "default": true,
          "description": "Detect drift between manifest and lock file"
        },
        "previous_sbom_path": {
          "type": "string",
          "default": "",
          "description": "Path to previous SBOM for drift detection comparison"
        }
      },
      "additionalProperties": false
    },
    "filtering": {
      "type": "object",
      "description": "Package filtering rules",
      "properties": {
        "exclude_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "default": [],
          "description": "Glob patterns for packages to exclude"
        },
        "include_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["*"],
          "description": "Glob patterns for packages to include"
        },
        "exclude_scopes": {
          "type": "array",
          "items": { "type": "string" },
          "default": [],
          "description": "Dependency scopes to exclude (e.g., 'test', 'dev')"
        }
      },
      "additionalProperties": false
    },
    "compliance": {
      "type": "object",
      "description": "Compliance and standards settings",
      "properties": {
        "ntia_minimum": {
          "type": "boolean",
          "default": true,
          "description": "Ensure NTIA minimum elements are included"
        },
        "cisa_2025": {
          "type": "boolean",
          "default": false,
          "description": "Enable CISA 2025 SBOM requirements"
        },
        "required_fields": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "supplier_name",
              "component_name",
              "version",
              "unique_identifier",
              "dependency_relationship",
              "author",
              "timestamp"
            ]
          },
          "default": ["supplier_name", "component_name", "version", "unique_identifier"],
          "description": "Required fields per NTIA minimum elements"
        }
      },
      "additionalProperties": false
    }
  },
  "definitions": {
    "ecosystem_tool_config": {
      "type": "object",
      "properties": {
        "tool": {
          "type": "string",
          "description": "Preferred tool for this ecosystem"
        },
        "fallback": {
          "type": "string",
          "description": "Fallback tool if preferred fails"
        },
        "options": {
          "type": "object",
          "description": "Tool-specific options",
          "additionalProperties": true
        }
      },
      "additionalProperties": false
    },
    "registry_config": {
      "type": "object",
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Registry URL"
        },
        "auth_type": {
          "type": "string",
          "enum": ["none", "basic", "token", "oauth"],
          "default": "none",
          "description": "Authentication type"
        },
        "auth_env_var": {
          "type": "string",
          "description": "Environment variable containing auth credentials"
        },
        "scopes": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Package scopes/namespaces for this registry"
        }
      },
      "additionalProperties": false
    },
    "npm_config": {
      "type": "object",
      "properties": {
        "use_native_sbom": {
          "type": "boolean",
          "default": true,
          "description": "Use npm sbom command (npm 9+)"
        },
        "omit": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["dev", "optional", "peer"]
          },
          "default": ["dev"],
          "description": "Dependency types to omit"
        },
        "package_lock_only": {
          "type": "boolean",
          "default": false,
          "description": "Generate from package-lock.json without node_modules"
        },
        "workspaces": {
          "type": "boolean",
          "default": true,
          "description": "Include workspace dependencies"
        }
      },
      "additionalProperties": false
    },
    "yarn_config": {
      "type": "object",
      "properties": {
        "berry_mode": {
          "type": "boolean",
          "default": false,
          "description": "Enable Yarn Berry (2.x+) specific handling"
        },
        "production_only": {
          "type": "boolean",
          "default": true,
          "description": "Include only production dependencies"
        },
        "workspaces": {
          "type": "boolean",
          "default": true,
          "description": "Include workspace dependencies"
        }
      },
      "additionalProperties": false
    },
    "pnpm_config": {
      "type": "object",
      "properties": {
        "production_only": {
          "type": "boolean",
          "default": true,
          "description": "Include only production dependencies"
        },
        "workspaces": {
          "type": "boolean",
          "default": true,
          "description": "Include workspace dependencies"
        },
        "filter": {
          "type": "string",
          "description": "pnpm filter pattern for specific packages"
        }
      },
      "additionalProperties": false
    },
    "pip_config": {
      "type": "object",
      "properties": {
        "requirements_file": {
          "type": "string",
          "default": "requirements.txt",
          "description": "Primary requirements file"
        },
        "use_environment": {
          "type": "boolean",
          "default": false,
          "description": "Generate from installed environment instead of files"
        },
        "fetch_pypi_metadata": {
          "type": "boolean",
          "default": true,
          "description": "Fetch additional metadata from PyPI"
        }
      },
      "additionalProperties": false
    },
    "poetry_config": {
      "type": "object",
      "properties": {
        "groups": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["main"],
          "description": "Dependency groups to include"
        },
        "extras": {
          "type": "array",
          "items": { "type": "string" },
          "default": [],
          "description": "Optional extras to include"
        },
        "from_lock_file": {
          "type": "boolean",
          "default": true,
          "description": "Generate from poetry.lock"
        }
      },
      "additionalProperties": false
    },
    "uv_config": {
      "type": "object",
      "properties": {
        "include_dev": {
          "type": "boolean",
          "default": false,
          "description": "Include dev dependencies"
        },
        "from_lock_file": {
          "type": "boolean",
          "default": true,
          "description": "Generate from uv.lock"
        }
      },
      "additionalProperties": false
    },
    "cargo_config": {
      "type": "object",
      "properties": {
        "include_dev": {
          "type": "boolean",
          "default": false,
          "description": "Include dev-dependencies"
        },
        "include_build": {
          "type": "boolean",
          "default": false,
          "description": "Include build-dependencies"
        },
        "all_features": {
          "type": "boolean",
          "default": false,
          "description": "Include all feature dependencies"
        },
        "features": {
          "type": "array",
          "items": { "type": "string" },
          "default": [],
          "description": "Specific features to include"
        }
      },
      "additionalProperties": false
    },
    "go_config": {
      "type": "object",
      "properties": {
        "include_test": {
          "type": "boolean",
          "default": false,
          "description": "Include test dependencies"
        },
        "include_std": {
          "type": "boolean",
          "default": false,
          "description": "Include standard library packages"
        },
        "from_binary": {
          "type": "boolean",
          "default": false,
          "description": "Extract from compiled binary"
        },
        "binary_path": {
          "type": "string",
          "description": "Path to compiled binary for extraction"
        }
      },
      "additionalProperties": false
    },
    "maven_config": {
      "type": "object",
      "properties": {
        "include_compile": {
          "type": "boolean",
          "default": true,
          "description": "Include compile scope"
        },
        "include_runtime": {
          "type": "boolean",
          "default": true,
          "description": "Include runtime scope"
        },
        "include_test": {
          "type": "boolean",
          "default": false,
          "description": "Include test scope"
        },
        "include_provided": {
          "type": "boolean",
          "default": false,
          "description": "Include provided scope"
        },
        "aggregate_modules": {
          "type": "boolean",
          "default": true,
          "description": "Aggregate multi-module projects"
        }
      },
      "additionalProperties": false
    },
    "gradle_config": {
      "type": "object",
      "properties": {
        "configurations": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["runtimeClasspath"],
          "description": "Gradle configurations to include"
        },
        "skip_configurations": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["testRuntimeClasspath", "testCompileClasspath"],
          "description": "Gradle configurations to skip"
        },
        "use_lock_file": {
          "type": "boolean",
          "default": true,
          "description": "Require gradle.lockfile"
        }
      },
      "additionalProperties": false
    },
    "bundler_config": {
      "type": "object",
      "properties": {
        "exclude_groups": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["development", "test"],
          "description": "Gem groups to exclude"
        },
        "include_groups": {
          "type": "array",
          "items": { "type": "string" },
          "default": [],
          "description": "Gem groups to include (overrides exclude)"
        }
      },
      "additionalProperties": false
    },
    "composer_config": {
      "type": "object",
      "properties": {
        "include_dev": {
          "type": "boolean",
          "default": false,
          "description": "Include require-dev dependencies"
        },
        "fetch_packagist_metadata": {
          "type": "boolean",
          "default": true,
          "description": "Fetch additional metadata from Packagist"
        }
      },
      "additionalProperties": false
    },
    "nuget_config": {
      "type": "object",
      "properties": {
        "include_transitive": {
          "type": "boolean",
          "default": true,
          "description": "Include transitive dependencies"
        },
        "exclude_dev": {
          "type": "boolean",
          "default": true,
          "description": "Exclude development dependencies"
        },
        "use_lock_file": {
          "type": "boolean",
          "default": true,
          "description": "Require packages.lock.json"
        },
        "target_frameworks": {
          "type": "array",
          "items": { "type": "string" },
          "default": [],
          "description": "Specific target frameworks to include"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
