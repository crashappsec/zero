{
  "$schema": "./zero.config.schema.json",
  "_version": "3.3.0",
  "_docs": "===================================================================================",
  "_docs2": "ZERO CONFIGURATION - Super Scanners Architecture (v3.3)",
  "_docs3": "===================================================================================",
  "_docs4": "Zero uses 9 consolidated 'super scanners' with configurable features:",
  "_docs5": "  - sbom: SBOM generation and integrity verification (source of truth)",
  "_docs6": "  - packages: vulnerabilities, health, malcontent, provenance, bundle, licenses, duplicates, recommendations, typosquats, deprecations, confusion, reachability",
  "_docs7": "  - crypto: ciphers, keys, random, tls, certificates",
  "_docs8": "  - code-security: vulns, secrets (RAG-based with API validation), api",
  "_docs9": "  - quality: tech_debt, complexity, test_coverage, documentation",
  "_docs10": "  - devops: iac, containers, github_actions, dora, git",
  "_docs11": "  - technology: detection, models, frameworks, datasets, ai_security, ai_governance, infrastructure (ML-BOM)",
  "_docs12": "  - ownership: contributors, bus_factor, codeowners, orphans, churn, patterns",
  "_docs13": "  - health: score, summary, recommendations, trends (aggregator)",
  "_docs14": "===================================================================================",
  "settings": {
    "default_profile": "standard",
    "storage_path": ".zero",
    "parallel_repos": 1,
    "parallel_scanners": 4,
    "scanner_timeout_seconds": 300,
    "cache_ttl_hours": 24,
    "environment": {
      "github_token_env": "GITHUB_TOKEN",
      "anthropic_key_env": "ANTHROPIC_API_KEY"
    }
  },
  "scanners": {
    "sbom": {
      "name": "SBOM",
      "description": "Software Bill of Materials generation and integrity verification - source of truth for package data",
      "estimated_time": "30-60s",
      "output_file": "sbom.json",
      "dependencies": [],
      "features": {
        "generation": {
          "enabled": true,
          "tool": "auto",
          "spec_version": "1.5",
          "fallback_to_syft": true
        },
        "integrity": {
          "enabled": true,
          "verify_lockfiles": true,
          "detect_drift": true
        }
      }
    },
    "packages": {
      "name": "Packages",
      "description": "Package/dependency analysis: vulnerabilities, health, malcontent, provenance, bundle optimization, licenses",
      "estimated_time": "60-180s",
      "output_file": "packages.json",
      "dependencies": ["sbom"],
      "features": {
        "vulns": {
          "enabled": true,
          "include_dev": false,
          "check_reachability": true
        },
        "health": {
          "enabled": true,
          "check_deprecated": true,
          "check_maintained": true,
          "check_downloads": true
        },
        "malcontent": {
          "enabled": true,
          "min_risk": "medium"
        },
        "provenance": {
          "enabled": true,
          "check_sigstore": true,
          "check_slsa": true
        },
        "bundle": {
          "enabled": true,
          "size_threshold_kb": 100
        },
        "licenses": {
          "enabled": true,
          "include_dev": false,
          "blocked_licenses": ["GPL-3.0", "AGPL-3.0"],
          "allowed_licenses": []
        },
        "duplicates": {
          "enabled": true
        },
        "recommendations": {
          "enabled": true
        },
        "typosquats": {
          "enabled": true
        },
        "deprecations": {
          "enabled": true
        },
        "confusion": {
          "enabled": true,
          "check_internal_names": true
        },
        "reachability": {
          "enabled": true,
          "filter_unreachable": false
        }
      }
    },
    "crypto": {
      "name": "Cryptography",
      "description": "Cryptographic security analysis: ciphers, keys, random number generation, TLS, certificates",
      "estimated_time": "30-90s",
      "output_file": "crypto.json",
      "dependencies": [],
      "features": {
        "ciphers": {
          "enabled": true,
          "check_weak": true,
          "check_deprecated": true
        },
        "keys": {
          "enabled": true,
          "check_hardcoded": true,
          "check_weak_length": true,
          "min_rsa_bits": 2048,
          "min_ec_bits": 256
        },
        "random": {
          "enabled": true,
          "check_insecure": true
        },
        "tls": {
          "enabled": true,
          "check_verification": true,
          "check_protocols": true,
          "min_version": "1.2"
        },
        "certificates": {
          "enabled": true,
          "check_expiry": true,
          "expiry_warning_days": 30
        }
      }
    },
    "code-security": {
      "name": "Code Security",
      "description": "Security-focused code analysis: vulnerabilities, RAG-based secrets detection, API security",
      "estimated_time": "60-180s",
      "output_file": "code-security.json",
      "dependencies": [],
      "features": {
        "vulns": {
          "enabled": true,
          "rulesets": ["p/security-audit", "p/owasp-top-ten"],
          "severity_minimum": "low"
        },
        "secrets": {
          "enabled": true,
          "detection_method": "rag",
          "rag_patterns_path": "rag/tech-id",
          "validate_with_api": true,
          "redact_secrets": true,
          "min_confidence": 0.8
        },
        "api": {
          "enabled": true,
          "check_openapi": true,
          "check_graphql": true,
          "check_owasp_api": true
        }
      }
    },
    "quality": {
      "name": "Code Quality",
      "description": "Code quality analysis: technical debt, complexity, test coverage, documentation",
      "estimated_time": "30-90s",
      "output_file": "quality.json",
      "dependencies": [],
      "features": {
        "tech_debt": {
          "enabled": true,
          "include_markers": true,
          "include_issues": true,
          "marker_types": ["TODO", "FIXME", "HACK", "XXX", "BUG", "WORKAROUND"]
        },
        "complexity": {
          "enabled": true,
          "check_cyclomatic": true,
          "check_cognitive": true,
          "check_nesting": true,
          "max_function_lines": 50,
          "max_cyclomatic": 10
        },
        "test_coverage": {
          "enabled": true,
          "parse_reports": true,
          "minimum_threshold": 80
        },
        "code_docs": {
          "enabled": true,
          "check_public_api": true,
          "check_readme": true
        }
      }
    },
    "devops": {
      "name": "DevOps",
      "description": "DevOps and infrastructure analysis: IaC security, containers, GitHub Actions, DORA metrics, git insights",
      "estimated_time": "60-180s",
      "output_file": "devops.json",
      "dependencies": [],
      "features": {
        "iac": {
          "enabled": true,
          "tool": "auto",
          "fallback_tool": true
        },
        "containers": {
          "enabled": true,
          "scan_base_images": true,
          "check_hardened": true
        },
        "github_actions": {
          "enabled": true,
          "check_pinning": true,
          "check_secrets": true,
          "check_injection": true,
          "check_permissions": true
        },
        "dora": {
          "enabled": true,
          "period_days": 90
        },
        "git": {
          "enabled": true,
          "include_churn": true,
          "include_age": true,
          "include_patterns": true,
          "include_branches": true
        }
      }
    },
    "tech-id": {
      "name": "Technology Identification",
      "description": "Technology detection and AI/ML analysis with ML-BOM generation",
      "estimated_time": "30-90s",
      "output_file": "tech-id.json",
      "dependencies": [],
      "features": {
        "detection": {
          "enabled": true,
          "tier": "auto",
          "rag_patterns_path": "rag/tech-id",
          "scan_extensions": true,
          "scan_config": true,
          "scan_sbom": true,
          "scan_imports": true
        },
        "models": {
          "enabled": true,
          "detect_model_files": true,
          "scan_code_patterns": true,
          "scan_configs": true,
          "query_registries": true
        },
        "frameworks": {
          "enabled": true,
          "detect_deep_learning": true,
          "detect_llm": true,
          "detect_mlops": true
        },
        "datasets": {
          "enabled": true,
          "detect_references": true,
          "check_provenance": true
        },
        "ai_security": {
          "enabled": true,
          "check_pickle_files": true,
          "detect_unsafe_loading": true,
          "check_api_key_exposure": true
        },
        "ai_governance": {
          "enabled": true,
          "require_model_cards": true,
          "require_license": true,
          "require_dataset_info": false,
          "blocked_licenses": ["CC-BY-NC-4.0", "proprietary"]
        },
        "infrastructure": {
          "enabled": true,
          "extract_registries": true,
          "extract_cloud_accounts": true,
          "extract_clusters": true
        }
      }
    },
    "ownership": {
      "name": "Code Ownership",
      "description": "Code ownership, contributor analysis, and team health metrics",
      "estimated_time": "30-60s",
      "output_file": "ownership.json",
      "dependencies": [],
      "features": {
        "contributors": {
          "enabled": true,
          "period_days": 90,
          "include_lines_changed": true,
          "group_by_email_domain": false
        },
        "bus_factor": {
          "enabled": true,
          "period_days": 365,
          "weight_by_recency": true
        },
        "codeowners": {
          "enabled": true,
          "check_coverage": true,
          "validate_owners": true,
          "check_conflicts": true
        },
        "orphans": {
          "enabled": true,
          "inactive_days": 180,
          "check_codeowners_coverage": true,
          "exclude_patterns": ["vendor/", "node_modules/", "*.generated.*"]
        },
        "churn": {
          "enabled": true,
          "period_days": 90,
          "min_changes": 5,
          "top_n": 30
        },
        "patterns": {
          "enabled": true,
          "include_time_distribution": true,
          "include_message_analysis": true
        }
      }
    },
    "health": {
      "name": "Project Health",
      "description": "Aggregate project health scoring and recommendations (meta-scanner)",
      "estimated_time": "10-30s",
      "output_file": "health.json",
      "dependencies": ["quality", "ownership", "packages", "code-security", "technology"],
      "features": {
        "score": {
          "enabled": true,
          "include_quality": true,
          "include_ownership": true,
          "include_security": true,
          "weights": {
            "quality": 0.30,
            "ownership": 0.25,
            "security": 0.25,
            "activity": 0.20
          }
        },
        "summary": {
          "enabled": true,
          "include_top_issues": true,
          "max_issues": 10
        },
        "recommendations": {
          "enabled": true,
          "priority_threshold": "medium",
          "max_recommendations": 10
        },
        "trends": {
          "enabled": true,
          "compare_to_previous": true,
          "history_days": 30
        }
      }
    }
  },
  "profiles": {
    "quick": {
      "name": "Quick",
      "description": "Fast essential analysis for rapid feedback",
      "estimated_time": "~30 seconds",
      "scanners": ["sbom", "package-analysis"],
      "feature_overrides": {
        "sbom": {
          "integrity": {"enabled": false}
        },
        "package-analysis": {
          "malcontent": {"enabled": false},
          "provenance": {"enabled": false},
          "bundle": {"enabled": false},
          "confusion": {"enabled": false},
          "reachability": {"enabled": false}
        }
      }
    },
    "standard": {
      "name": "Standard",
      "description": "Balanced analysis covering security and code quality",
      "estimated_time": "~2 minutes",
      "scanners": ["sbom", "package-analysis", "code-security", "code-quality"],
      "feature_overrides": {
        "package-analysis": {
          "bundle": {"enabled": false},
          "reachability": {"enabled": false}
        }
      }
    },
    "security": {
      "name": "Security",
      "description": "Security-focused analysis for vulnerability assessment",
      "estimated_time": "~4 minutes",
      "scanners": ["sbom", "package-analysis", "crypto", "code-security", "devops"],
      "feature_overrides": {
        "devops": {
          "dora": {"enabled": false},
          "git": {"enabled": false}
        }
      }
    },
    "full": {
      "name": "Full",
      "description": "Complete analysis with all features enabled",
      "estimated_time": "~12 minutes",
      "scanners": ["sbom", "package-analysis", "crypto", "code-security", "code-quality", "devops", "tech-id", "code-ownership"]
    },
    "ai-security": {
      "name": "AI/ML Security",
      "description": "AI/ML focused security analysis with ML-BOM generation",
      "estimated_time": "~3 minutes",
      "scanners": ["sbom", "package-analysis", "code-security", "tech-id"],
      "feature_overrides": {
        "package-analysis": {
          "bundle": {"enabled": false},
          "recommendations": {"enabled": false}
        }
      }
    },
    "sbom-only": {
      "name": "SBOM Only",
      "description": "SBOM generation and integrity verification only",
      "estimated_time": "~1 minute",
      "scanners": ["sbom"]
    },
    "package-analysis-only": {
      "name": "Package Analysis Only",
      "description": "Complete package/dependency analysis",
      "estimated_time": "~3 minutes",
      "scanners": ["sbom", "package-analysis"]
    },
    "crypto-only": {
      "name": "Cryptography Only",
      "description": "Comprehensive cryptographic security analysis",
      "estimated_time": "~2 minutes",
      "scanners": ["crypto"]
    },
    "code-security-only": {
      "name": "Code Security Only",
      "description": "Security-focused code analysis only",
      "estimated_time": "~3 minutes",
      "scanners": ["code-security"]
    },
    "code-quality-only": {
      "name": "Code Quality Only",
      "description": "Code quality analysis: tech debt, complexity, coverage",
      "estimated_time": "~2 minutes",
      "scanners": ["code-quality"]
    },
    "devops-only": {
      "name": "DevOps Only",
      "description": "DevOps and infrastructure analysis",
      "estimated_time": "~3 minutes",
      "scanners": ["devops"]
    },
    "tech-id-only": {
      "name": "Technology Identification Only",
      "description": "Technology detection and AI/ML analysis with ML-BOM",
      "estimated_time": "~2 minutes",
      "scanners": ["tech-id"]
    },
    "code-ownership-only": {
      "name": "Code Ownership Only",
      "description": "Code ownership and contributor analysis",
      "estimated_time": "~1 minute",
      "scanners": ["code-ownership"]
    },
    "compliance": {
      "name": "Compliance",
      "description": "License and policy compliance checks",
      "estimated_time": "~2 minutes",
      "scanners": ["sbom", "package-analysis", "tech-id"],
      "feature_overrides": {
        "package-analysis": {
          "vulns": {"enabled": false},
          "malcontent": {"enabled": false},
          "provenance": {"enabled": false},
          "bundle": {"enabled": false},
          "duplicates": {"enabled": false},
          "recommendations": {"enabled": false},
          "typosquats": {"enabled": false},
          "confusion": {"enabled": false},
          "reachability": {"enabled": false}
        },
        "tech-id": {
          "ai_security": {"enabled": false},
          "infrastructure": {"enabled": false}
        }
      }
    },
    "ci-cd": {
      "name": "CI/CD",
      "description": "CI/CD pipeline and operational metrics",
      "estimated_time": "~3 minutes",
      "scanners": ["devops", "code-ownership"],
      "feature_overrides": {
        "devops": {
          "iac": {"enabled": false},
          "containers": {"enabled": false}
        },
        "code-ownership": {
          "orphans": {"enabled": false},
          "codeowners": {"enabled": false}
        }
      }
    },
    "supply-chain": {
      "name": "Supply Chain",
      "description": "Complete supply chain security analysis",
      "estimated_time": "~5 minutes",
      "scanners": ["sbom", "package-analysis", "tech-id"],
      "feature_overrides": {
        "tech-id": {
          "infrastructure": {"enabled": false}
        }
      }
    }
  }
}
