{
  "$schema": "./zero.config.schema.json",
  "_version": "3.3.0",
  "_docs": "===================================================================================",
  "_docs2": "ZERO CONFIGURATION - Super Scanners Architecture (v3.3)",
  "_docs3": "===================================================================================",
  "_docs4": "Zero uses 10 consolidated 'super scanners' with configurable features:",
  "_docs5": "  - sbom: SBOM generation and integrity verification (source of truth)",
  "_docs6": "  - packages: vulnerabilities, health, malcontent, provenance, bundle, licenses, duplicates, recommendations, typosquats, deprecations, confusion, reachability",
  "_docs7": "  - crypto: ciphers, keys, random, tls, certificates",
  "_docs8": "  - code-security: vulns, secrets (RAG-based with API validation), api",
  "_docs9": "  - quality: tech_debt, complexity, test_coverage, documentation",
  "_docs10": "  - devops: iac, containers, github_actions, dora, git",
  "_docs11": "  - technology: detection, models, frameworks, datasets, ai_security, ai_governance, infrastructure (ML-BOM)",
  "_docs12": "  - ownership: contributors, bus_factor, codeowners, orphans, churn, patterns",
  "_docs13": "  - health: score, summary, recommendations, trends (aggregator)",
  "_docs14": "  - developer-experience: onboarding, tooling, workflow (developer experience)",
  "_docs15": "===================================================================================",
  "settings": {
    "default_profile": "all-quick",
    "storage_path": ".zero",
    "parallel_repos": 8,
    "parallel_scanners": 4,
    "scanner_timeout_seconds": 300,
    "cache_ttl_hours": 24,
    "environment": {
      "github_token_env": "GITHUB_TOKEN",
      "anthropic_key_env": "ANTHROPIC_API_KEY"
    },
    "history": {
      "enabled": true,
      "retention_days": 90,
      "max_scans": 50,
      "compress_old": true
    }
  },
  "scanners": {
    "sbom": {
      "name": "SBOM",
      "description": "Software Bill of Materials generation and integrity verification - source of truth for package data",
      "estimated_time": "30-60s",
      "output_file": "sbom.json",
      "dependencies": [],
      "features": {
        "generation": {
          "enabled": true,
          "tool": "auto",
          "spec_version": "1.5",
          "fallback_to_syft": true
        },
        "integrity": {
          "enabled": true,
          "verify_lockfiles": true,
          "detect_drift": true
        }
      }
    },
    "packages": {
      "name": "Packages",
      "description": "Package/dependency analysis: vulnerabilities, health, malcontent, provenance, bundle optimization, licenses",
      "estimated_time": "60-180s",
      "output_file": "packages.json",
      "dependencies": ["sbom"],
      "features": {
        "vulns": {
          "enabled": true,
          "include_dev": false,
          "check_reachability": true
        },
        "health": {
          "enabled": true,
          "check_deprecated": true,
          "check_maintained": true,
          "check_downloads": true
        },
        "malcontent": {
          "enabled": true,
          "min_risk": "medium"
        },
        "provenance": {
          "enabled": true,
          "check_sigstore": true,
          "check_slsa": true
        },
        "bundle": {
          "enabled": true,
          "size_threshold_kb": 100
        },
        "licenses": {
          "enabled": true,
          "include_dev": false,
          "blocked_licenses": ["GPL-3.0", "AGPL-3.0"],
          "allowed_licenses": []
        },
        "duplicates": {
          "enabled": true
        },
        "recommendations": {
          "enabled": true
        },
        "typosquats": {
          "enabled": true
        },
        "deprecations": {
          "enabled": true
        },
        "confusion": {
          "enabled": true,
          "check_internal_names": true
        },
        "reachability": {
          "enabled": true,
          "filter_unreachable": false
        }
      }
    },
    "crypto": {
      "name": "Cryptography",
      "description": "Cryptographic security analysis: ciphers, keys, random number generation, TLS, certificates",
      "estimated_time": "30-90s",
      "output_file": "crypto.json",
      "dependencies": [],
      "features": {
        "ciphers": {
          "enabled": true,
          "check_weak": true,
          "check_deprecated": true
        },
        "keys": {
          "enabled": true,
          "check_hardcoded": true,
          "check_weak_length": true,
          "min_rsa_bits": 2048,
          "min_ec_bits": 256
        },
        "random": {
          "enabled": true,
          "check_insecure": true
        },
        "tls": {
          "enabled": true,
          "check_verification": true,
          "check_protocols": true,
          "min_version": "1.2"
        },
        "certificates": {
          "enabled": true,
          "check_expiry": true,
          "expiry_warning_days": 30
        }
      }
    },
    "code-security": {
      "name": "Code Security",
      "description": "Security-focused code analysis: vulnerabilities, RAG-based secrets detection, API security",
      "estimated_time": "60-180s",
      "output_file": "code-security.json",
      "dependencies": [],
      "features": {
        "vulns": {
          "enabled": true,
          "rulesets": ["p/security-audit", "p/owasp-top-ten"],
          "severity_minimum": "low"
        },
        "secrets": {
          "enabled": true,
          "detection_method": "rag",
          "rag_patterns_path": "rag/tech-id",
          "validate_with_api": true,
          "redact_secrets": true,
          "min_confidence": 0.8
        },
        "api": {
          "enabled": true,
          "check_openapi": true,
          "check_graphql": true,
          "check_owasp_api": true
        }
      }
    },
    "quality": {
      "name": "Code Quality",
      "description": "Code quality analysis: technical debt, complexity, test coverage, documentation",
      "estimated_time": "30-90s",
      "output_file": "quality.json",
      "dependencies": [],
      "features": {
        "tech_debt": {
          "enabled": true,
          "include_markers": true,
          "include_issues": true,
          "marker_types": ["TODO", "FIXME", "HACK", "XXX", "BUG", "WORKAROUND"]
        },
        "complexity": {
          "enabled": true,
          "check_cyclomatic": true,
          "check_cognitive": true,
          "check_nesting": true,
          "max_function_lines": 50,
          "max_cyclomatic": 10
        },
        "test_coverage": {
          "enabled": true,
          "parse_reports": true,
          "minimum_threshold": 80
        },
        "code_docs": {
          "enabled": true,
          "check_public_api": true,
          "check_readme": true
        }
      }
    },
    "devops": {
      "name": "DevOps",
      "description": "DevOps and infrastructure analysis: IaC security, containers, GitHub Actions, DORA metrics, git insights",
      "estimated_time": "60-180s",
      "output_file": "devops.json",
      "dependencies": [],
      "features": {
        "iac": {
          "enabled": true,
          "tool": "auto",
          "fallback_tool": true
        },
        "containers": {
          "enabled": true,
          "scan_base_images": true,
          "check_hardened": true
        },
        "github_actions": {
          "enabled": true,
          "check_pinning": true,
          "check_secrets": true,
          "check_injection": true,
          "check_permissions": true
        },
        "dora": {
          "enabled": true,
          "period_days": 90
        },
        "git": {
          "enabled": true,
          "include_churn": true,
          "include_age": true,
          "include_patterns": true,
          "include_branches": true
        }
      }
    },
    "tech-id": {
      "name": "Technology Identification",
      "description": "Technology detection and AI/ML analysis with ML-BOM generation",
      "estimated_time": "30-90s",
      "output_file": "tech-id.json",
      "dependencies": [],
      "features": {
        "detection": {
          "enabled": true,
          "tier": "auto",
          "rag_patterns_path": "rag/tech-id",
          "scan_extensions": true,
          "scan_config": true,
          "scan_sbom": true,
          "scan_imports": true
        },
        "models": {
          "enabled": true,
          "detect_model_files": true,
          "scan_code_patterns": true,
          "scan_configs": true,
          "query_registries": true
        },
        "frameworks": {
          "enabled": true,
          "detect_deep_learning": true,
          "detect_llm": true,
          "detect_mlops": true
        },
        "datasets": {
          "enabled": true,
          "detect_references": true,
          "check_provenance": true
        },
        "ai_security": {
          "enabled": true,
          "check_pickle_files": true,
          "detect_unsafe_loading": true,
          "check_api_key_exposure": true
        },
        "ai_governance": {
          "enabled": true,
          "require_model_cards": true,
          "require_license": true,
          "require_dataset_info": false,
          "blocked_licenses": ["CC-BY-NC-4.0", "proprietary"]
        },
        "infrastructure": {
          "enabled": true,
          "extract_registries": true,
          "extract_cloud_accounts": true,
          "extract_clusters": true
        }
      }
    },
    "ownership": {
      "name": "Code Ownership",
      "description": "Code ownership, contributor analysis, and team health metrics",
      "estimated_time": "30-60s",
      "output_file": "ownership.json",
      "dependencies": [],
      "features": {
        "contributors": {
          "enabled": true,
          "period_days": 90,
          "include_lines_changed": true,
          "group_by_email_domain": false
        },
        "bus_factor": {
          "enabled": true,
          "period_days": 365,
          "weight_by_recency": true
        },
        "codeowners": {
          "enabled": true,
          "check_coverage": true,
          "validate_owners": true,
          "check_conflicts": true
        },
        "orphans": {
          "enabled": true,
          "inactive_days": 180,
          "check_codeowners_coverage": true,
          "exclude_patterns": ["vendor/", "node_modules/", "*.generated.*"]
        },
        "churn": {
          "enabled": true,
          "period_days": 90,
          "min_changes": 5,
          "top_n": 30
        },
        "patterns": {
          "enabled": true,
          "include_time_distribution": true,
          "include_message_analysis": true
        }
      }
    },
    "health": {
      "name": "Project Health",
      "description": "Aggregate project health scoring and recommendations (meta-scanner)",
      "estimated_time": "10-30s",
      "output_file": "health.json",
      "dependencies": ["quality", "ownership", "packages", "code-security", "technology"],
      "features": {
        "score": {
          "enabled": true,
          "include_quality": true,
          "include_ownership": true,
          "include_security": true,
          "weights": {
            "quality": 0.30,
            "ownership": 0.25,
            "security": 0.25,
            "activity": 0.20
          }
        },
        "summary": {
          "enabled": true,
          "include_top_issues": true,
          "max_issues": 10
        },
        "recommendations": {
          "enabled": true,
          "priority_threshold": "medium",
          "max_recommendations": 10
        },
        "trends": {
          "enabled": true,
          "compare_to_previous": true,
          "history_days": 30
        }
      }
    },
    "developer-experience": {
      "name": "Developer Experience",
      "description": "Developer experience analysis: onboarding friction, sprawl analysis (tools + technologies), workflow efficiency",
      "estimated_time": "15-30s",
      "output_file": "developer-experience.json",
      "dependencies": ["tech-id"],
      "features": {
        "onboarding": {
          "enabled": true,
          "check_readme_quality": true,
          "check_contributing": true,
          "check_env_setup": true
        },
        "sprawl": {
          "enabled": true,
          "check_tool_sprawl": true,
          "check_technology_sprawl": true,
          "check_config_complexity": true,
          "max_recommended_tools": 10,
          "max_recommended_technologies": 15,
          "tool_categories": ["linter", "formatter", "bundler", "test", "ci-cd", "build"],
          "technology_categories": ["language", "framework", "database", "cloud", "container", "infrastructure"]
        },
        "workflow": {
          "enabled": true,
          "check_pr_templates": true,
          "check_local_dev": true,
          "check_feedback_loop": true
        }
      }
    }
  },
  "profiles": {
    "all-quick": {
      "name": "All Quick",
      "description": "All scanners with limited features for fast feedback",
      "estimated_time": "~2 minutes",
      "scanners": ["sbom", "packages", "crypto", "code-security", "code-quality", "devops", "tech-id", "code-ownership", "developer-experience"],
      "feature_overrides": {
        "sbom": {
          "integrity": {"enabled": false}
        },
        "packages": {
          "malcontent": {"enabled": false},
          "provenance": {"enabled": false},
          "bundle": {"enabled": false},
          "confusion": {"enabled": false},
          "reachability": {"enabled": false}
        },
        "devops": {
          "dora": {"enabled": false}
        },
        "code-ownership": {
          "orphans": {"enabled": false},
          "churn": {"enabled": false}
        }
      }
    },
    "all-complete": {
      "name": "All Complete",
      "description": "All scanners with all features enabled",
      "estimated_time": "~12 minutes",
      "scanners": ["sbom", "packages", "crypto", "code-security", "code-quality", "devops", "tech-id", "code-ownership", "developer-experience"]
    },
    "sbom": {
      "name": "SBOM",
      "description": "SBOM generation and integrity verification",
      "estimated_time": "~1 minute",
      "scanners": ["sbom"]
    },
    "packages": {
      "name": "Packages",
      "description": "Package/dependency analysis (vulnerabilities, licenses, health)",
      "estimated_time": "~3 minutes",
      "scanners": ["sbom", "packages"]
    },
    "crypto": {
      "name": "Cryptography",
      "description": "Cryptographic security analysis",
      "estimated_time": "~2 minutes",
      "scanners": ["crypto"]
    },
    "code-security": {
      "name": "Code Security",
      "description": "SAST, secrets detection, API security",
      "estimated_time": "~3 minutes",
      "scanners": ["code-security"]
    },
    "code-quality": {
      "name": "Code Quality",
      "description": "Tech debt, complexity, test coverage",
      "estimated_time": "~2 minutes",
      "scanners": ["code-quality"]
    },
    "devops": {
      "name": "DevOps",
      "description": "IaC, containers, GitHub Actions, DORA metrics",
      "estimated_time": "~3 minutes",
      "scanners": ["devops"]
    },
    "tech-id": {
      "name": "Technology Identification",
      "description": "Technology detection and ML-BOM generation",
      "estimated_time": "~2 minutes",
      "scanners": ["tech-id"]
    },
    "code-ownership": {
      "name": "Code Ownership",
      "description": "Contributors, bus factor, CODEOWNERS analysis",
      "estimated_time": "~1 minute",
      "scanners": ["code-ownership"]
    },
    "developer-experience": {
      "name": "Developer Experience",
      "description": "Onboarding, tooling sprawl, workflow analysis",
      "estimated_time": "~1 minute",
      "scanners": ["tech-id", "developer-experience"]
    }
  }
}
