<!--
Copyright (c) 2025 Crash Override Inc. - https://crashoverride.com
SPDX-License-Identifier: GPL-3.0
-->

# CVE Remediation Workflows

## Vulnerability Lifecycle

### Discovery → Triage → Remediation → Verification

```
┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐
│  Discovery  │ → │   Triage    │ → │ Remediation │ → │ Verification│
│  (Scanner)  │   │  (4 hours)  │   │  (Per SLA)  │   │  (Rescan)   │
└─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘
```

## Triage Process

### Initial Assessment (Within 4 Hours)

1. **Verify the Finding**
   - Is this a true positive?
   - Is the vulnerable code actually reachable?
   - Are there existing compensating controls?

2. **Determine Exposure**
   - Internet-facing vs internal
   - Production vs non-production
   - Data sensitivity of affected system

3. **Check for Exploitation**
   - Is there a public exploit?
   - Is it being actively exploited (KEV)?
   - What is the EPSS score?

4. **Assign Priority**
   - P0: Critical + KEV or Critical + Public Exploit
   - P1: Critical without exploit or High + Public Exploit
   - P2: High without exploit or Medium + factors
   - P3: Medium standard
   - P4: Low

### Triage Documentation Template

```markdown
## CVE Triage: [CVE-YYYY-NNNNN]

**Package:** [name@version]
**CVSS:** [score] ([vector])
**KEV:** [Yes/No]
**EPSS:** [percentage]

### Exposure Assessment
- Environment: [Production/Staging/Dev]
- Network: [Internet-facing/Internal]
- Data: [Sensitive/Non-sensitive]

### Exploitation Status
- Public Exploit: [Yes/No/PoC Only]
- Active Exploitation: [Yes/No/Unknown]

### Priority: [P0/P1/P2/P3/P4]
### SLA: [Timeline]

### Remediation Path
- [ ] Option 1: Upgrade to [version]
- [ ] Option 2: Apply patch [reference]
- [ ] Option 3: Compensating control [description]
```

## Remediation SLAs

### Standard SLA Matrix

| Priority | Production | Staging | Development |
|----------|------------|---------|-------------|
| P0 | 24 hours | 48 hours | 72 hours |
| P1 | 7 days | 14 days | 30 days |
| P2 | 14 days | 30 days | 60 days |
| P3 | 30 days | 60 days | 90 days |
| P4 | 90 days | 90 days | Best effort |

### SLA Exceptions

Valid reasons for SLA extension:
- Fix introduces breaking changes requiring significant refactoring
- Vendor patch not yet available
- Change freeze period (document compensating controls)

Extension approval requirements:
- P0/P1: VP Engineering + CISO approval
- P2/P3: Director approval
- P4: Manager approval

## Remediation Strategies

### Strategy 1: Upgrade (Preferred)

```bash
# NPM
npm install package@fixed-version
npm audit fix

# Python
pip install package==fixed-version
pip-audit --fix

# Go
go get package@v1.2.3
go mod tidy
```

**When to use:** When upgrade path is available and tested

### Strategy 2: Patch Application

When official patch available but upgrade not possible:
- Apply vendor security patch
- Document patch in configuration management
- Monitor for follow-up patches

### Strategy 3: Workaround/Configuration Change

Examples:
- Disable vulnerable feature
- Change configuration to non-vulnerable setting
- Add input validation

**Document:**
- What was changed
- Why full fix isn't possible
- Timeline for proper fix

### Strategy 4: Compensating Controls

When patching is not immediately possible:
- Network segmentation
- WAF rules
- Enhanced monitoring
- Access restrictions

**Requirements for compensating controls:**
- Must be approved by security leadership
- Must be time-limited (max 90 days)
- Must be documented in risk register

### Strategy 5: Risk Acceptance

Only for P3/P4 with:
- No practical remediation path
- Minimal exposure
- Strong compensating controls
- Executive sign-off

## Verification Process

### Post-Remediation Steps

1. **Rescan the target**
   ```bash
   # Verify fix
   osv-scanner --lockfile package-lock.json
   ```

2. **Verify in production**
   - Confirm deployment completed
   - Check for service disruption
   - Monitor for regression

3. **Update documentation**
   - Close ticket with evidence
   - Update asset inventory
   - Record MTTR metrics

### Verification Checklist

- [ ] Vulnerability scanner shows resolved
- [ ] No regression in functionality
- [ ] Ticket updated with evidence
- [ ] Metrics recorded

## Metrics and Reporting

### Key Metrics

| Metric | Definition | Target |
|--------|------------|--------|
| MTTR (Mean Time to Remediate) | Time from discovery to verified fix | <7 days (Critical) |
| SLA Compliance | % within SLA | >95% |
| Open CVE Count | Active unresolved CVEs | Trending down |
| CVE Age | Average days open | <30 days |

### Reporting Cadence

- **Daily:** P0/P1 status to security leadership
- **Weekly:** All priorities to engineering leads
- **Monthly:** Metrics dashboard to executives
- **Quarterly:** Trend analysis and process improvements

## Escalation Procedures

### When to Escalate

- SLA breach imminent
- Remediation blocked by dependencies
- Vendor non-responsive
- Risk acceptance request

### Escalation Path

1. **Technical blocker:** Engineering Manager → Director
2. **Resource constraint:** Director → VP
3. **Risk acceptance:** VP → CISO
4. **Executive exception:** CISO → CEO/Board
