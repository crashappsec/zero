<!--
Copyright (c) 2025 Crash Override Inc. - https://crashoverride.com
SPDX-License-Identifier: GPL-3.0
-->

# Vulnerability Scoring Models

## CVSS (Common Vulnerability Scoring System)

### CVSS v3.1 Overview

CVSS provides a standardized way to assess vulnerability severity. It consists of
three metric groups: Base, Temporal, and Environmental.

### Base Score Interpretation

| Score Range | Severity | Description |
|-------------|----------|-------------|
| 0.0 | None | No impact |
| 0.1 - 3.9 | Low | Limited impact, local exploitation |
| 4.0 - 6.9 | Medium | Partial impact, some conditions required |
| 7.0 - 8.9 | High | Significant impact, easier exploitation |
| 9.0 - 10.0 | Critical | Full compromise, trivial exploitation |

### CVSS Vector Breakdown

```
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
        │    │    │    │    │   │   │   │
        │    │    │    │    │   │   │   └─ Availability Impact
        │    │    │    │    │   │   └───── Integrity Impact
        │    │    │    │    │   └───────── Confidentiality Impact
        │    │    │    │    └───────────── Scope
        │    │    │    └────────────────── User Interaction
        │    │    └─────────────────────── Privileges Required
        │    └──────────────────────────── Attack Complexity
        └───────────────────────────────── Attack Vector
```

### Key Metrics for Prioritization

**Attack Vector (AV)**
- Network (N): Most dangerous, remotely exploitable
- Adjacent (A): Same network segment required
- Local (L): Local access required
- Physical (P): Physical access required

**Privileges Required (PR)**
- None (N): No authentication needed
- Low (L): Basic user privileges
- High (H): Admin/root required

**User Interaction (UI)**
- None (N): No user action required (wormable)
- Required (R): User must click link, open file, etc.

### High-Risk CVSS Patterns

```
AV:N/AC:L/PR:N/UI:N  → Wormable, maximum exposure
AV:N/AC:L/PR:N/UI:R  → Phishing vector, still critical
AV:N/AC:L/PR:L/UI:N  → Authenticated RCE, high priority
```

## EPSS (Exploit Prediction Scoring System)

### Overview

EPSS predicts the probability that a vulnerability will be exploited in the next
30 days. It complements CVSS by adding real-world exploitation likelihood.

### EPSS Score Interpretation

| Score | Percentile | Meaning |
|-------|------------|---------|
| >0.9 | Top 1% | Very high likelihood of exploitation |
| >0.5 | Top 5% | High likelihood of exploitation |
| >0.1 | Top 20% | Elevated likelihood |
| <0.1 | Bottom 80% | Lower likelihood |

### Using EPSS for Prioritization

**EPSS + CVSS Combined Priority:**

| CVSS | EPSS >50% | EPSS 10-50% | EPSS <10% |
|------|-----------|-------------|-----------|
| Critical | P0 (24h) | P0 (48h) | P1 (7d) |
| High | P0 (48h) | P1 (7d) | P2 (14d) |
| Medium | P1 (7d) | P2 (14d) | P3 (30d) |
| Low | P2 (14d) | P3 (30d) | P4 (90d) |

## Contextual Scoring

### Environmental Factors

Beyond base CVSS, consider:

1. **Asset Criticality**
   - Business-critical system
   - Data sensitivity
   - Regulatory requirements

2. **Exposure**
   - Internet-facing
   - Internal only
   - Air-gapped

3. **Existing Controls**
   - WAF protection
   - Network segmentation
   - Monitoring coverage

### Contextual Score Adjustments

```
Final Priority = Base CVSS + Adjustments

Adjustments:
  +2 if internet-facing
  +2 if business-critical
  +1 if contains PII/sensitive data
  +3 if in CISA KEV
  +2 if EPSS >50%
  -1 if strong compensating controls
  -2 if isolated network segment
```

## CWE (Common Weakness Enumeration)

### High-Risk CWE Categories

| CWE | Name | Risk Level |
|-----|------|------------|
| CWE-78 | OS Command Injection | Critical |
| CWE-89 | SQL Injection | Critical |
| CWE-94 | Code Injection | Critical |
| CWE-502 | Deserialization | Critical |
| CWE-287 | Improper Authentication | High |
| CWE-306 | Missing Authentication | High |
| CWE-79 | Cross-Site Scripting | Medium-High |
| CWE-22 | Path Traversal | Medium-High |

### CWE to Attack Chain Mapping

```
CWE-89 (SQLi) → Data exfiltration, auth bypass
CWE-78 (CMDi) → RCE, lateral movement
CWE-502 (Deser) → RCE, persistence
CWE-287 (Auth) → Unauthorized access, privilege escalation
```

## Scoring in Practice

### Recommended Priority Algorithm

```python
def calculate_priority(cvss, epss, kev, exposure, criticality):
    # Start with CVSS-based priority
    if cvss >= 9.0:
        priority = 0
    elif cvss >= 7.0:
        priority = 1
    elif cvss >= 4.0:
        priority = 2
    else:
        priority = 3

    # KEV always elevates to P0
    if kev:
        priority = 0

    # EPSS adjustments
    if epss > 0.5:
        priority = max(0, priority - 1)
    elif epss > 0.1:
        priority = max(0, priority - 0.5)

    # Exposure adjustments
    if exposure == "internet":
        priority = max(0, priority - 0.5)
    elif exposure == "internal":
        priority = priority + 0.5

    # Criticality adjustments
    if criticality == "high":
        priority = max(0, priority - 0.5)

    return round(priority)
```

### Output Format

```json
{
  "cve": "CVE-2021-44228",
  "cvss_score": 10.0,
  "cvss_severity": "Critical",
  "epss_score": 0.975,
  "epss_percentile": 99.9,
  "kev_listed": true,
  "calculated_priority": "P0",
  "sla_hours": 24,
  "scoring_factors": [
    "CVSS Critical (10.0)",
    "KEV Listed",
    "EPSS Top 1%",
    "Internet-facing"
  ]
}
```

## References

- CVSS v3.1 Specification: https://www.first.org/cvss/v3.1/specification-document
- CVSS v4.0 Specification: https://www.first.org/cvss/v4.0/specification-document
- EPSS: https://www.first.org/epss/
- CWE Database: https://cwe.mitre.org/
- NVD: https://nvd.nist.gov/
