rules:
- id: zero.api-auth.missing-authentication-middleware
  message: Missing Authentication Middleware
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-306
    owasp:
    - API2:2023
  pattern-regex: app\.(get|post|put|delete|patch)\s*\(\s*['"][^'"]+['"]\s*,\s*(?!.*(?:auth|authenticate|isAuthenticated|requireAuth|verifyToken|passport|jwt|session)).*\(\s*req\s*,\s*res
- id: zero.api-auth.missing-authentication-middleware-1
  message: Missing Authentication Middleware
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-306
    owasp:
    - API2:2023
  pattern-regex: '@app\.(get|post|put|delete|patch)\s*\([^)]*\)\s*\n(?:async\s+)?def\s+\w+\s*\([^)]*\)(?!.*Depends)'
- id: zero.api-auth.missing-authentication-middleware-2
  message: Missing Authentication Middleware
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-306
    owasp:
    - API2:2023
  pattern-regex: '@app\.route\s*\([^)]+\)\s*\ndef\s+\w+\s*\((?!.*login_required|auth_required)'
- id: zero.api-auth.broken-object-level-authorization-bola
  message: Broken Object Level Authorization (BOLA)
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-639
    owasp:
    - API1:2023
  pattern-regex: \.(findById|findOne|findByPk|get)\s*\(\s*(req\.params\.|req\.query\.|request\.args)
- id: zero.api-auth.broken-object-level-authorization-bola-1
  message: Broken Object Level Authorization (BOLA)
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-639
    owasp:
    - API1:2023
  pattern-regex: (user_id|userId|user\.id)\s*=\s*(req\.params|req\.query|request\.args|request\.form)
- id: zero.api-auth.missing-jwt-validation
  message: Missing JWT Validation
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-287
    owasp:
    - API2:2023
  pattern-regex: jwt\.decode\s*\([^)]*verify\s*=\s*False
- id: zero.api-auth.missing-jwt-validation-1
  message: Missing JWT Validation
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-287
    owasp:
    - API2:2023
  pattern-regex: jwt\.(sign|verify)\s*\([^)]*\)(?!.*algorithm)
- id: zero.api-auth.missing-jwt-validation-2
  message: Missing JWT Validation
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-287
    owasp:
    - API2:2023
  pattern-regex: algorithms?\s*[=:]\s*\[.*['"]none['"]
- id: zero.api-auth.hardcoded-jwt-secrets
  message: Hardcoded JWT Secrets
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-798
    owasp:
    - API2:2023
  pattern-regex: (jwt_secret|JWT_SECRET|secret_key|SECRET_KEY)\s*[=:]\s*['"][^'"]{8,}['"]
- id: zero.api-auth.session-fixation
  message: Session Fixation
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-auth
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-384
    owasp:
    - API2:2023
  pattern-regex: (login|authenticate|signin).*\{[^}]*(?!regenerate|destroy|create).*session
- id: zero.api-auth.missing-cors-authentication
  message: Missing CORS Authentication
  severity: WARNING
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-942
    owasp:
    - API2:2023
  pattern-regex: (credentials|withCredentials)\s*[=:]\s*true.*origin\s*[=:]\s*['"]\*['"]
- id: zero.api-auth.broken-function-level-authorization
  message: Broken Function Level Authorization
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-285
    owasp:
    - API5:2023
  pattern-regex: (\/admin|\/manage|\/internal|\/system).*(?!role|permission|isAdmin|authorize)
- id: zero.api-auth.api-key-in-url
  message: API Key in URL
  severity: WARNING
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-auth
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-598
    owasp:
    - API2:2023
  pattern-regex: (api_key|apikey|api-key|access_token)\s*=\s*(req\.query|request\.args|params\[)
- id: zero.api-data-exposure.excessive-data-exposure
  message: Excessive Data Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: res\.(json|send)\s*\(\s*(user|account|profile|customer)\s*\)
- id: zero.api-data-exposure.excessive-data-exposure-1
  message: Excessive Data Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (SELECT|select)\s+\*\s+FROM.*(res\.|return|response)
- id: zero.api-data-exposure.excessive-data-exposure-2
  message: Excessive Data Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: \.(find|findOne|findAll|findById)\s*\([^)]*\)(?!.*\.(select|lean|attributes))
- id: zero.api-data-exposure.password-in-response
  message: Password in Response
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (toJSON|toObject)\s*\([^)]*\)(?!.*password).*res\.(json|send)
- id: zero.api-data-exposure.password-in-response-1
  message: Password in Response
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-data-exposure
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (password|password_hash|passwordHash|hashed_password)\s*[=:][^,}]*[,}][^}]*(res\.|return|response)
- id: zero.api-data-exposure.sensitive-fields-exposure
  message: Sensitive Fields Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-data-exposure
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (ssn|social_security|credit_card|creditCard|cardNumber|card_number|tax_id|taxId)\s*[=:][^}]*(res\.|return|response)
- id: zero.api-data-exposure.sensitive-fields-exposure-1
  message: Sensitive Fields Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-data-exposure
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (_id|internal_id|internalId|system_id|db_id)\s*[=:][^}]*(res\.|return|response)
- id: zero.api-data-exposure.debug-information-leakage
  message: Debug Information Leakage
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-209
    owasp:
    - API3:2023
  pattern-regex: (res\.(json|send)|return)\s*\([^)]*\b(stack|stackTrace|trace)\b
- id: zero.api-data-exposure.debug-information-leakage-1
  message: Debug Information Leakage
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-209
    owasp:
    - API3:2023
  pattern-regex: catch\s*\([^)]*\)\s*\{[^}]*(res\.(json|send)|return)[^}]*\berr(or)?\.(message|stack)
- id: zero.api-data-exposure.verbose-error-messages
  message: Verbose Error Messages
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-209
    owasp:
    - API3:2023
  pattern-regex: (SequelizeError|MongoError|PrismaClientKnownRequestError|DatabaseError)[^}]*(res\.|return)
- id: zero.api-data-exposure.api-enumeration
  message: API Enumeration
  severity: WARNING
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-data-exposure
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-204
    owasp:
    - API3:2023
  pattern-regex: (user|email|account)\s+(not found|doesn't exist|does not exist|invalid)
- id: zero.api-data-exposure.graphql-introspection-enabled
  message: GraphQL Introspection Enabled
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: introspection\s*[=:]\s*true
- id: zero.api-data-exposure.graphql-introspection-enabled-1
  message: GraphQL Introspection Enabled
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (ApolloServer|GraphQLServer|graphqlHTTP)\s*\(\s*\{(?!.*introspection\s*[=:]\s*false)
- id: zero.api-data-exposure.sensitive-data-in-logs
  message: Sensitive Data in Logs
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-532
    owasp:
    - API3:2023
  pattern-regex: (log|logger|console)\.(info|debug|warn|error)\s*\([^)]*\b(password|token|secret|apiKey|api_key|authorization)\b
- id: zero.api-data-exposure.mass-assignment-exposure
  message: Mass Assignment Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: (create|update|save)\s*\(\s*req\.body\s*\)
- id: zero.api-data-exposure.mass-assignment-exposure-1
  message: Mass Assignment Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \{\s*\.\.\.req\.body\s*\}
- id: zero.api-data-exposure.internal-endpoint-exposure
  message: Internal Endpoint Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API6:2023
  pattern-regex: (\/internal|\/admin|\/debug|\/metrics|\/health|\/status).*app\.(get|post|use)(?!.*auth)
- id: zero.api-data-exposure.internal-endpoint-exposure-1
  message: Internal Endpoint Exposure
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  - java
  metadata:
    category: api-data-exposure
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API6:2023
  pattern-regex: (\/actuator|\/env|\/heapdump|\/threaddump)
- id: zero.api-data-exposure.response-header-leakage
  message: Response Header Leakage
  severity: INFO
  languages:
  - javascript
  - typescript
  metadata:
    category: api-data-exposure
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-200
    owasp:
    - API3:2023
  pattern-regex: (X-Powered-By|Server)\s*[=:]\s*['"][^'"]+['"]
- id: zero.api-injection.sql-injection-in-apis
  message: SQL Injection in APIs
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-injection
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-89
    owasp:
    - A03:2021
  pattern-regex: (execute|query|raw)\s*\([^)]*(\+|`\$\{|\.format\(|%s|%d).*req\.(body|params|query)
- id: zero.api-injection.sql-injection-in-apis-1
  message: SQL Injection in APIs
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-89
    owasp:
    - A03:2021
  pattern-regex: (execute|query|raw)\s*\(`[^`]*\$\{.*req\.(body|params|query)
- id: zero.api-injection.sql-injection-in-apis-2
  message: SQL Injection in APIs
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-injection
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-89
    owasp:
    - A03:2021
  pattern-regex: (execute|cursor\.execute)\s*\(\s*f['"][^'"]*\{.*request\.(args|form|json)
- id: zero.api-injection.nosql-injection
  message: NoSQL Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-943
    owasp:
    - A03:2021
  pattern-regex: \.(find|findOne|findOneAndUpdate|updateOne|deleteOne)\s*\(\s*\{[^}]*req\.(body|params|query)
- id: zero.api-injection.nosql-injection-1
  message: NoSQL Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-943
    owasp:
    - A03:2021
  pattern-regex: \$where\s*[=:]\s*.*req\.(body|params|query)
- id: zero.api-injection.nosql-injection-2
  message: NoSQL Injection
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-injection
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-943
    owasp:
    - A03:2021
  pattern-regex: (find|find_one|update_one|delete_one)\s*\(\s*\{.*request\.(args|form|json)
- id: zero.api-injection.command-injection-in-apis
  message: Command Injection in APIs
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-injection
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-78
    owasp:
    - A03:2021
  pattern-regex: (exec|spawn|execSync|execFile|system|popen|subprocess)\s*\([^)]*req\.(body|params|query)
- id: zero.api-injection.command-injection-in-apis-1
  message: Command Injection in APIs
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-78
    owasp:
    - A03:2021
  pattern-regex: '`[^`]*\$\{.*req\.(body|params|query).*\}[^`]*`'
- id: zero.api-injection.ldap-injection
  message: LDAP Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-injection
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-90
    owasp:
    - A03:2021
  pattern-regex: (search|bind)\s*\([^)]*(\+|`\$\{|\.format\(|%s).*req\.(body|params|query)
- id: zero.api-injection.xpath-injection
  message: XPath Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-injection
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-643
    owasp:
    - A03:2021
  pattern-regex: (xpath|evaluate|selectNodes)\s*\([^)]*(\+|`\$\{|\.format\().*req\.(body|params|query)
- id: zero.api-injection.header-injection
  message: Header Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-113
    owasp:
    - A03:2021
  pattern-regex: (setHeader|set|header)\s*\([^,]+,\s*req\.(body|params|query)
- id: zero.api-injection.log-injection
  message: Log Injection
  severity: WARNING
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-injection
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-117
    owasp:
    - A09:2021
  pattern-regex: (logger\.|console\.|log\.)(info|warn|error|debug)\s*\([^)]*req\.(body|params|query)\.[^)]*\)
- id: zero.api-injection.template-injection-ssti
  message: Template Injection (SSTI)
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-injection
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-1336
    owasp:
    - A03:2021
  pattern-regex: (render_template_string|Template|render_string)\s*\([^)]*req\.(body|params|query)
- id: zero.api-injection.template-injection-ssti-1
  message: Template Injection (SSTI)
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-injection
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-1336
    owasp:
    - A03:2021
  pattern-regex: Environment\s*\([^)]*autoescape\s*=\s*False
- id: zero.api-injection.graphql-injection
  message: GraphQL Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-89
    owasp:
    - A03:2021
  pattern-regex: (graphql|query)\s*[=:]\s*[`'"].*\$\{.*req\.(body|params|query)
- id: zero.api-injection.orm-injection
  message: ORM Injection
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-injection
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-89
    owasp:
    - A03:2021
  pattern-regex: Sequelize\.literal\s*\([^)]*req\.(body|params|query)
- id: zero.api-injection.orm-injection-1
  message: ORM Injection
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-injection
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-89
    owasp:
    - A03:2021
  pattern-regex: (text|literal_column)\s*\([^)]*request\.(args|form|json)
- id: zero.api-mass-assignment.direct-request-body-assignment
  message: Direct Request Body Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \.(create|update|updateOne|findOneAndUpdate|save)\s*\(\s*req\.body\s*\)
- id: zero.api-mass-assignment.direct-request-body-assignment-1
  message: Direct Request Body Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \{\s*\.\.\.req\.body\s*[,}]
- id: zero.api-mass-assignment.direct-request-body-assignment-2
  message: Direct Request Body Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: Object\.assign\s*\([^,]+,\s*req\.body
- id: zero.api-mass-assignment.python-mass-assignment
  message: Python Mass Assignment
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \.(update|filter)\s*\([^)]*\)\.(update|values)\s*\(\s*\*\*request\.(json|form)
- id: zero.api-mass-assignment.python-mass-assignment-1
  message: Python Mass Assignment
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \.(create|update|update_or_create)\s*\(\s*\*\*request\.(POST|data|json)
- id: zero.api-mass-assignment.python-mass-assignment-2
  message: Python Mass Assignment
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \w+Model\s*\(\s*\*\*request\.(json|data)\s*\)
- id: zero.api-mass-assignment.mongoose-mass-assignment
  message: Mongoose Mass Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: (findByIdAndUpdate|findOneAndUpdate|updateOne|updateMany)\s*\([^,]+,\s*req\.body
- id: zero.api-mass-assignment.mongoose-mass-assignment-1
  message: Mongoose Mass Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: new\s+\w+Model\s*\(\s*req\.body\s*\)
- id: zero.api-mass-assignment.sequelize-mass-assignment
  message: Sequelize Mass Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \w+\.(create|update|bulkCreate)\s*\(\s*req\.body
- id: zero.api-mass-assignment.prisma-mass-assignment
  message: Prisma Mass Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: prisma\.\w+\.(create|update|upsert)\s*\(\s*\{\s*data\s*:\s*req\.body
- id: zero.api-mass-assignment.ruby-on-rails-mass-assignment
  message: Ruby on Rails Mass Assignment
  severity: ERROR
  languages:
  - ruby
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: \.(create|update|new)\s*\(\s*params(?!\.(permit|require))
- id: zero.api-mass-assignment.sensitive-field-modification
  message: Sensitive Field Modification
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-mass-assignment
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: (role|isAdmin|is_admin|admin|permission|permissions|privilege)\s*[=:]\s*req\.(body|params|query)
- id: zero.api-mass-assignment.sensitive-field-modification-1
  message: Sensitive Field Modification
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-mass-assignment
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: (status|active|verified|approved|enabled)\s*[=:]\s*req\.(body|params|query)
- id: zero.api-mass-assignment.http-parameter-pollution
  message: HTTP Parameter Pollution
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-235
    owasp:
    - API3:2023
  pattern-regex: req\.(query|params)\[['"][^'"]+['"]\]\s*(?!\.filter|\.map|\.every|\.some)
- id: zero.api-mass-assignment.graphql-mass-assignment
  message: GraphQL Mass Assignment
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: (args|input)\s*=>\s*\w+\.(create|update)\s*\(\s*(args|input)
- id: zero.api-mass-assignment.prototype-pollution
  message: Prototype Pollution
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-1321
    owasp:
    - API3:2023
  pattern-regex: (merge|extend|assign|defaults)\s*\([^,]+,\s*req\.(body|params|query)
- id: zero.api-mass-assignment.prototype-pollution-1
  message: Prototype Pollution
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-1321
    owasp:
    - API3:2023
  pattern-regex: _\.(merge|defaultsDeep|set)\s*\([^,]+,\s*req\.(body|params|query)
- id: zero.api-mass-assignment.field-blacklist-vs-whitelist
  message: Field Blacklist vs Whitelist
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-915
    owasp:
    - API3:2023
  pattern-regex: delete\s+req\.body\.(password|role|admin|isAdmin)
- id: zero.api-mass-assignment.missing-input-validation-schema
  message: Missing Input Validation Schema
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-mass-assignment
    confidence: 70
    scanner: api-security
    cwe:
    - CWE-20
    owasp:
    - API3:2023
  pattern-regex: app\.(post|put|patch)\s*\([^)]+,\s*(?!.*validate|validator|schema|joi|yup|zod).*\(req
- id: zero.api-rate-limiting.missing-rate-limiting
  message: Missing Rate Limiting
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: const\s+app\s*=\s*express\s*\(\)(?![\s\S]*rate-limit|rateLimit|rateLimiter)
- id: zero.api-rate-limiting.missing-rate-limiting-1
  message: Missing Rate Limiting
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (\/login|\/signin|\/auth|\/authenticate).*app\.(post|get)(?!.*rateLimit|rateLimiter)
- id: zero.api-rate-limiting.missing-rate-limiting-2
  message: Missing Rate Limiting
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (\/reset-password|\/forgot-password|\/password-reset).*app\.(post|get)(?!.*rateLimit)
- id: zero.api-rate-limiting.missing-request-size-limits
  message: Missing Request Size Limits
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (bodyParser|express)\.(json|urlencoded)\s*\(\s*\)
- id: zero.api-rate-limiting.missing-request-size-limits-1
  message: Missing Request Size Limits
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: multer\s*\(\s*\{(?!.*limits)
- id: zero.api-rate-limiting.missing-pagination
  message: Missing Pagination
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 70
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: \.(find|findAll|findMany)\s*\(\s*\{(?!.*limit|take|first)
- id: zero.api-rate-limiting.missing-pagination-1
  message: Missing Pagination
  severity: WARNING
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-rate-limiting
    confidence: 70
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (SELECT|select)(?!.*LIMIT|limit).*FROM.*res\.(json|send)
- id: zero.api-rate-limiting.graphql-complexity-limits
  message: GraphQL Complexity Limits
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (ApolloServer|GraphQLServer)\s*\(\s*\{(?!.*depthLimit|queryComplexity|maxDepth)
- id: zero.api-rate-limiting.graphql-complexity-limits-1
  message: GraphQL Complexity Limits
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (ApolloServer|GraphQLServer)\s*\(\s*\{(?!.*complexity|costAnalysis)
- id: zero.api-rate-limiting.unrestricted-file-upload
  message: Unrestricted File Upload
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (upload|multer|formidable|busboy)(?!.*fileSize|maxFileSize|limits)
- id: zero.api-rate-limiting.unrestricted-file-upload-1
  message: Unrestricted File Upload
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (\.array|\.fields)\s*\([^)]*\)(?!.*maxCount|limits)
- id: zero.api-rate-limiting.regex-dos-redos
  message: Regex DoS (ReDoS)
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-1333
    owasp:
    - API4:2023
  pattern-regex: new\s+RegExp\s*\(\s*req\.(body|params|query)
- id: zero.api-rate-limiting.regex-dos-redos-1
  message: Regex DoS (ReDoS)
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-1333
    owasp:
    - API4:2023
  pattern-regex: \/\([^)]*[\*\+]\)[^\/]*[\*\+]\/
- id: zero.api-rate-limiting.missing-timeout
  message: Missing Timeout
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (axios|fetch|request|got)\s*\(\s*[^)]*\)(?!.*timeout)
- id: zero.api-rate-limiting.missing-timeout-1
  message: Missing Timeout
  severity: WARNING
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (query|execute)\s*\(\s*[^)]*\)(?!.*timeout|maxTimeMS)
- id: zero.api-rate-limiting.memory-exhaustion
  message: Memory Exhaustion
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: \[\s*\]\.push\s*\([^)]*req\.(body|params|query)
- id: zero.api-rate-limiting.memory-exhaustion-1
  message: Memory Exhaustion
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (readFileSync|readFile)\s*\([^)]*req\.(body|params|query)
- id: zero.api-rate-limiting.connection-pool-exhaustion
  message: Connection Pool Exhaustion
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (createConnection|connect)\s*\([^)]*\)(?!.*pool|poolSize|connectionLimit)
- id: zero.api-rate-limiting.batch-operation-limits
  message: Batch Operation Limits
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 70
    scanner: api-security
    cwe:
    - CWE-770
    owasp:
    - API4:2023
  pattern-regex: (bulkCreate|insertMany|bulkWrite)\s*\(\s*req\.body(?!.*limit)
- id: zero.api-rate-limiting.cpu-intensive-operations
  message: CPU-Intensive Operations
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: (pbkdf2Sync|scryptSync|hashSync)\s*\([^)]*req\.(body|params|query)
- id: zero.api-rate-limiting.cpu-intensive-operations-1
  message: CPU-Intensive Operations
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-rate-limiting
    confidence: 75
    scanner: api-security
    cwe:
    - CWE-400
    owasp:
    - API4:2023
  pattern-regex: JSON\.parse\s*\(\s*req\.(body|params|query)
- id: zero.api-ssrf.direct-url-from-request
  message: Direct URL from Request
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (fetch|axios|got|request|http\.get|https\.get)\s*\(\s*req\.(body|params|query)\.(url|uri|href|link|target|redirect)
- id: zero.api-ssrf.direct-url-from-request-1
  message: Direct URL from Request
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-ssrf
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: requests\.(get|post|put|delete|head|patch)\s*\(\s*request\.(args|form|json)\.(url|uri|href|link|target)
- id: zero.api-ssrf.url-construction-from-user-input
  message: URL Construction from User Input
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (http|https):\/\/.*(\+|`\$\{).*req\.(body|params|query)
- id: zero.api-ssrf.url-construction-from-user-input-1
  message: URL Construction from User Input
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: '`(http|https):\/\/\$\{.*req\.(body|params|query)'
- id: zero.api-ssrf.url-construction-from-user-input-2
  message: URL Construction from User Input
  severity: ERROR
  languages:
  - python
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: f['"](http|https):\/\/.*\{.*request\.(args|form|json)
- id: zero.api-ssrf.image-file-url-fetch
  message: Image/File URL Fetch
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (imageUrl|image_url|avatarUrl|avatar_url|fileUrl|file_url|pictureUrl)\s*=\s*req\.(body|params|query)
- id: zero.api-ssrf.image-file-url-fetch-1
  message: Image/File URL Fetch
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (download|fetch|get).*\(\s*req\.(body|params|query)\.(url|path|file|image)
- id: zero.api-ssrf.webhook-url
  message: Webhook URL
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (webhook|callback|notify|endpoint).*=\s*req\.(body|params|query)
- id: zero.api-ssrf.xml-external-entity-xxe
  message: XML External Entity (XXE)
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-611
    owasp:
    - API7:2023
  pattern-regex: (DOMParser|xml2js|xmldom|libxmljs|etree\.parse|lxml\.etree)(?!.*resolveExternals\s*[=:]\s*false|noent\s*[=:]\s*false)
- id: zero.api-ssrf.xml-external-entity-xxe-1
  message: XML External Entity (XXE)
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-611
    owasp:
    - API7:2023
  pattern-regex: (parseXML|parse).*\{[^}]*(resolveExternals|expandEntities|loadExternalDTD)\s*[=:]\s*true
- id: zero.api-ssrf.pdf-generation-ssrf
  message: PDF Generation SSRF
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (puppeteer|playwright|pdf|wkhtmltopdf|phantom).*(goto|navigate|url|create)\s*\([^)]*req\.(body|params|query)
- id: zero.api-ssrf.html-rendering-ssrf
  message: HTML Rendering SSRF
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (page\.goto|page\.navigate|browser\.newPage).*req\.(body|params|query)
- id: zero.api-ssrf.cloud-metadata-access
  message: Cloud Metadata Access
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  - java
  - go
  metadata:
    category: api-ssrf
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: 169\.254\.169\.254
- id: zero.api-ssrf.cloud-metadata-access-1
  message: Cloud Metadata Access
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  - java
  - go
  metadata:
    category: api-ssrf
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: metadata\.google\.internal
- id: zero.api-ssrf.cloud-metadata-access-2
  message: Cloud Metadata Access
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  - java
  - go
  metadata:
    category: api-ssrf
    confidence: 95
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: 169\.254\.169\.254.*metadata
- id: zero.api-ssrf.dns-rebinding-vulnerability
  message: DNS Rebinding Vulnerability
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (isValid|validate|check).*url.*\n.*fetch\s*\(\s*\1
- id: zero.api-ssrf.internal-network-access
  message: Internal Network Access
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (127\.|10\.|172\.(1[6-9]|2[0-9]|3[01])\.|192\.168\.|localhost|0\.0\.0\.0)
- id: zero.api-ssrf.redirect-following
  message: Redirect Following
  severity: WARNING
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 80
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (followRedirects?|maxRedirects|redirect)\s*[=:]\s*(true|[1-9])
- id: zero.api-ssrf.graphql-ssrf
  message: GraphQL SSRF
  severity: ERROR
  languages:
  - generic
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: (imageUrl|profileUrl|webhookUrl|callbackUrl)\s*:\s*String
- id: zero.api-ssrf.import-from-url
  message: Import from URL
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: import\s*\(\s*req\.(body|params|query)
- id: zero.api-ssrf.import-from-url-1
  message: Import from URL
  severity: ERROR
  languages:
  - javascript
  - typescript
  metadata:
    category: api-ssrf
    confidence: 90
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: require\s*\(\s*req\.(body|params|query)
- id: zero.api-ssrf.protocol-handler-ssrf
  message: Protocol Handler SSRF
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: file:\/\/
- id: zero.api-ssrf.protocol-handler-ssrf-1
  message: Protocol Handler SSRF
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: gopher:\/\/
- id: zero.api-ssrf.protocol-handler-ssrf-2
  message: Protocol Handler SSRF
  severity: ERROR
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-ssrf
    confidence: 85
    scanner: api-security
    cwe:
    - CWE-918
    owasp:
    - API7:2023
  pattern-regex: dict:\/\/
- id: zero.api-versioning.url-path-versioning
  message: URL Path Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  - java
  - go
  metadata:
    category: api-versioning
    confidence: 90
    scanner: api-security
  pattern-regex: \/v[0-9]+\/
- id: zero.api-versioning.url-path-versioning-1
  message: URL Path Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  - java
  - go
  metadata:
    category: api-versioning
    confidence: 90
    scanner: api-security
  pattern-regex: \/v[0-9]+\.[0-9]+\/
- id: zero.api-versioning.header-versioning
  message: Header Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 85
    scanner: api-security
  pattern-regex: (X-API-Version|Accept-Version|Api-Version)\s*[=:]
- id: zero.api-versioning.header-versioning-1
  message: Header Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 85
    scanner: api-security
  pattern-regex: Accept.*application\/vnd\.[^+]+\+json;\s*version=
- id: zero.api-versioning.query-parameter-versioning
  message: Query Parameter Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 85
    scanner: api-security
  pattern-regex: '[\?&]version=[0-9]'
- id: zero.api-versioning.query-parameter-versioning-1
  message: Query Parameter Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 85
    scanner: api-security
  pattern-regex: '[\?&]api[-_]?version=[0-9]'
- id: zero.api-versioning.deprecated-api-endpoints
  message: Deprecated API Endpoints
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  - java
  metadata:
    category: api-versioning
    confidence: 80
    scanner: api-security
  pattern-regex: (@deprecated|@Deprecated|# deprecated|// deprecated|DEPRECATED)
- id: zero.api-versioning.deprecated-api-endpoints-1
  message: Deprecated API Endpoints
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 80
    scanner: api-security
  pattern-regex: Sunset\s*[=:]
- id: zero.api-versioning.deprecated-api-endpoints-2
  message: Deprecated API Endpoints
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 80
    scanner: api-security
  pattern-regex: Deprecation\s*[=:]
- id: zero.api-versioning.version-mismatch
  message: Version Mismatch
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 70
    scanner: api-security
  pattern-regex: (\/v1\/.*\/v2\/|\/v2\/.*\/v1\/)
- id: zero.api-versioning.missing-version
  message: Missing Version
  severity: INFO
  languages:
  - javascript
  - typescript
  metadata:
    category: api-versioning
    confidence: 60
    scanner: api-security
  pattern-regex: app\.(get|post|put|delete)\s*\(\s*['"]\/api\/(?!v[0-9])
- id: zero.api-versioning.legacy-api-versions
  message: Legacy API Versions
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 75
    scanner: api-security
  pattern-regex: \/v[0-1]\/
- id: zero.api-versioning.graphql-versioning
  message: GraphQL Versioning
  severity: INFO
  languages:
  - javascript
  - typescript
  - python
  metadata:
    category: api-versioning
    confidence: 80
    scanner: api-security
  pattern-regex: (schemaVersion|schema_version|apiVersion)\s*[=:]\s*['"][0-9]
- id: zero.api-versioning.openapi-version-spec
  message: OpenAPI Version Spec
  severity: INFO
  languages:
  - yaml
  - json
  metadata:
    category: api-versioning
    confidence: 90
    scanner: api-security
  pattern-regex: (openapi|swagger)\s*[=:]\s*['"][0-9]+\.[0-9]+
- id: zero.api-versioning.openapi-version-spec-1
  message: OpenAPI Version Spec
  severity: INFO
  languages:
  - yaml
  - json
  metadata:
    category: api-versioning
    confidence: 90
    scanner: api-security
  pattern-regex: info\s*:[\s\S]*?version\s*[=:]\s*['"][0-9]+\.[0-9]+
