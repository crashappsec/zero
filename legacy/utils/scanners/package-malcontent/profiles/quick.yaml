# Malcontent Quick Profile
# Fast scanning with critical-only threshold
#
# Usage: malcontent.sh --profile quick <repo>

profile:
  name: quick
  description: Fast scan for critical threats only

settings:
  mode: scan
  min_risk: critical
  format: json

# Only analyze high-risk file types
include:
  # Binaries
  - "**/*.so"
  - "**/*.dylib"
  - "**/*.dll"
  - "**/*.exe"
  # Key scripts
  - "**/*.sh"
  - "**/*.py"
  - "**/*.js"
  # Install scripts
  - "**/install*"
  - "**/setup*"
  - "**/post-install*"
  - "**/pre-install*"

# Aggressive exclusions for speed
exclude:
  - "**/node_modules/**"
  - "**/vendor/**"
  - "**/.git/**"
  - "**/test/**"
  - "**/tests/**"
  - "**/spec/**"
  - "**/fixtures/**"
  - "**/__pycache__/**"
  - "**/dist/**"
  - "**/build/**"
  - "**/target/**"
  - "**/.venv/**"
  - "**/venv/**"
  - "**/env/**"
  - "**/.tox/**"
  - "**/coverage/**"
  - "**/.coverage/**"
  - "**/docs/**"
  - "**/documentation/**"
  - "**/*.md"
  - "**/*.txt"
  - "**/*.rst"
  - "**/*.json"
  - "**/*.yaml"
  - "**/*.yml"
  - "**/*.xml"
  - "**/*.html"
  - "**/*.css"
  - "**/*.svg"
  - "**/*.png"
  - "**/*.jpg"
  - "**/*.gif"

# Risk thresholds
thresholds:
  # Only alert on critical
  alert_on:
    - critical
  # Fail only on critical
  fail_on:
    - critical

# Only detect most severe behaviors
behaviors:
  critical:
    - backdoor
    - rootkit
    - ransomware
    - cryptominer
    - c2_communication
    - reverse_shell

output:
  format: json
  include_details: false
  max_findings: 100
