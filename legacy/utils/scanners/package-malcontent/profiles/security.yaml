# Malcontent Security Profile
# Comprehensive security scanning with low risk threshold
#
# Usage: malcontent.sh --profile security <repo>

profile:
  name: security
  description: Comprehensive security scan for supply chain threats

settings:
  mode: analyze
  min_risk: low
  format: json

# Analyze all potentially risky file types
include:
  # Binaries (all platforms)
  - "**/*.so"
  - "**/*.so.*"
  - "**/*.dylib"
  - "**/*.dll"
  - "**/*.exe"
  - "**/*.bin"
  - "**/*.elf"
  # Mach-O binaries (macOS)
  - "**/Contents/MacOS/*"
  # Scripts (all common languages)
  - "**/*.sh"
  - "**/*.bash"
  - "**/*.zsh"
  - "**/*.fish"
  - "**/*.py"
  - "**/*.pyw"
  - "**/*.rb"
  - "**/*.pl"
  - "**/*.php"
  - "**/*.js"
  - "**/*.mjs"
  - "**/*.cjs"
  - "**/*.ts"
  - "**/*.go"
  - "**/*.rs"
  - "**/*.lua"
  - "**/*.ps1"
  - "**/*.psm1"
  - "**/*.bat"
  - "**/*.cmd"
  - "**/*.vbs"
  # Build/Config files
  - "**/Makefile"
  - "**/GNUmakefile"
  - "**/makefile"
  - "**/Dockerfile"
  - "**/docker-compose*.yml"
  - "**/Containerfile"
  - "**/.github/workflows/*.yml"
  - "**/.github/workflows/*.yaml"
  - "**/.gitlab-ci.yml"
  - "**/Jenkinsfile"
  - "**/.travis.yml"
  - "**/azure-pipelines.yml"
  - "**/bitbucket-pipelines.yml"
  - "**/cloudbuild.yaml"
  # Package manager scripts
  - "**/package.json"
  - "**/setup.py"
  - "**/setup.cfg"
  - "**/pyproject.toml"
  - "**/Gemfile"
  - "**/Rakefile"
  - "**/Cargo.toml"
  - "**/build.gradle"
  - "**/build.gradle.kts"
  - "**/pom.xml"
  # Terraform/IaC
  - "**/*.tf"
  - "**/*.hcl"
  # Kubernetes
  - "**/k8s/**/*.yaml"
  - "**/kubernetes/**/*.yaml"
  - "**/helm/**/*.yaml"

# Minimal exclusions for security profile
exclude:
  - "**/.git/**"
  - "**/__pycache__/**"
  - "**/*.pyc"

# Risk thresholds
thresholds:
  # Alert on all risk levels
  alert_on:
    - critical
    - high
    - medium
    - low
  # Fail on high and critical
  fail_on:
    - critical
    - high

# Full behavior detection
behaviors:
  critical:
    - backdoor
    - rootkit
    - keylogger
    - ransomware
    - cryptominer
    - c2_communication
    - reverse_shell
    - bind_shell
    - dropper
    - wiper
  high:
    - shell_execution
    - process_injection
    - credential_theft
    - credential_access
    - network_exfiltration
    - persistence_mechanism
    - dll_injection
    - process_hollowing
    - code_injection
    - memory_manipulation
  medium:
    - obfuscation
    - anti_debugging
    - anti_vm
    - anti_sandbox
    - privilege_escalation
    - system_modification
    - registry_modification
    - scheduled_task
    - file_encryption
  low:
    - network_communication
    - file_system_access
    - process_creation
    - environment_discovery
    - system_information
    - user_discovery

output:
  format: json
  include_details: true
  include_raw_rules: true
  max_findings: 2000
